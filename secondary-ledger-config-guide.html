<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Oracle Fusion Secondary Ledger — Configuration Guide</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Bitter:ital,wght@0,400;0,600;0,700;1,400&family=Barlow:wght@400;500;600;700&family=DM+Mono:wght@400;500&display=swap" rel="stylesheet">
<style>
*{box-sizing:border-box;margin:0;padding:0}
:root{
  --bg:#F5F4F0;
  --surface:#FFFFFF;
  --surface2:#F0EEE9;
  --border:#DDD9D0;
  --border2:#C8C2B4;
  --ink:#1C1A16;
  --ink2:#4A4540;
  --ink3:#8A8278;
  --oracle:#B8300A;
  --oracle-lt:#E84520;
  --oracle-pale:#FFF0EC;
  --oracle-border:#F4BEB0;
  --blue:#1D4E89;
  --blue-lt:#2E6DB8;
  --blue-pale:#EBF2FA;
  --blue-border:#AACCE8;
  --gold:#8B6914;
  --gold-lt:#C49A1E;
  --gold-pale:#FDF8EC;
  --gold-border:#E8D4A0;
  --green:#1A6B3A;
  --green-lt:#23924F;
  --green-pale:#EBF5EE;
  --green-border:#A8DDB8;
  --teal:#0F6B6B;
  --teal-pale:#E8F5F5;
  --teal-border:#88CCCC;
  --warn:#7A4010;
  --warn-pale:#FEF3EB;
  --warn-border:#E8B888;
  --phase1:#1D4E89;
  --phase2:#8B2E00;
  --r:6px;
}
html{scroll-behavior:smooth}
body{font-family:'Barlow',sans-serif;background:var(--bg);color:var(--ink);font-size:15px;line-height:1.65;-webkit-font-smoothing:antialiased}

/* ── LAYOUT ── */
.shell{display:grid;grid-template-columns:260px 1fr;min-height:100vh;max-width:1280px;margin:0 auto}
@media(max-width:900px){.shell{grid-template-columns:1fr}.sidebar{display:none}}

/* ── SIDEBAR ── */
.sidebar{background:var(--ink);position:sticky;top:0;height:100vh;overflow-y:auto;padding:0;display:flex;flex-direction:column}
.sidebar-brand{padding:24px 20px 20px;border-bottom:1px solid #2A2820}
.brand-label{font-family:'DM Mono',monospace;font-size:9px;letter-spacing:.16em;text-transform:uppercase;color:#5A5848;margin-bottom:6px}
.brand-title{font-family:'Bitter',serif;font-size:16px;font-weight:700;color:#E8E4DC;line-height:1.3}

.nav-section{padding:16px 0 8px}
.nav-section-label{font-family:'DM Mono',monospace;font-size:9px;letter-spacing:.16em;text-transform:uppercase;color:#5A5848;padding:0 20px;margin-bottom:6px;display:flex;align-items:center;gap:8px}
.nav-phase-dot{width:8px;height:8px;border-radius:50%;flex-shrink:0}
.dot-p1{background:var(--blue-lt)}
.dot-p2{background:var(--oracle)}

.nav-item{display:flex;align-items:center;gap:10px;padding:8px 20px;cursor:pointer;transition:all .15s;border-left:3px solid transparent;text-decoration:none}
.nav-item:hover{background:#1A1812;border-left-color:#3A3828}
.nav-item.active{background:#1E1C14;border-left-color:var(--gold-lt)}
.nav-num{font-family:'DM Mono',monospace;font-size:10px;color:#4A4838;width:20px;flex-shrink:0}
.nav-item.active .nav-num{color:var(--gold-lt)}
.nav-text{font-size:12px;font-weight:600;color:#8A8470}
.nav-item.active .nav-text{color:#E8E0CC}
.nav-item:hover .nav-text{color:#B0A890}
.nav-item.complete .nav-num::after{content:'✓';color:var(--green-lt)}
.nav-item.complete .nav-text{color:#6A6858}

.nav-sub{padding:4px 20px 4px 50px;cursor:pointer;font-size:11px;color:#4A4838;transition:color .15s}
.nav-sub:hover{color:#8A8470}
.nav-sub.active{color:var(--gold-lt)}

.sidebar-filter{padding:16px 20px;border-top:1px solid #2A2820;margin-top:auto}
.filter-label{font-family:'DM Mono',monospace;font-size:9px;letter-spacing:.14em;text-transform:uppercase;color:#5A5848;margin-bottom:10px;display:block}
.filter-chips{display:flex;flex-wrap:wrap;gap:5px}
.chip{font-family:'DM Mono',monospace;font-size:9px;letter-spacing:.06em;text-transform:uppercase;padding:4px 8px;border-radius:2px;border:1px solid #3A3828;color:#6A6858;cursor:pointer;transition:all .15s;user-select:none}
.chip:hover{border-color:#5A5848;color:#8A8470}
.chip.active{background:var(--oracle);border-color:var(--oracle);color:#fff}

/* ── MAIN ── */
.main{padding:0;overflow:hidden}

/* ── TOP BAR ── */
.topbar{background:var(--surface);border-bottom:1px solid var(--border);padding:16px 40px;display:flex;align-items:center;gap:16px;position:sticky;top:0;z-index:10}
.topbar-progress{flex:1;display:flex;align-items:center;gap:12px}
.tp-label{font-family:'DM Mono',monospace;font-size:9px;letter-spacing:.12em;text-transform:uppercase;color:var(--ink3);white-space:nowrap}
.progress-track{flex:1;height:4px;background:var(--border);border-radius:2px;overflow:hidden}
.progress-fill{height:100%;background:linear-gradient(90deg,var(--blue),var(--oracle));border-radius:2px;transition:width .4s cubic-bezier(.4,0,.2,1)}
.tp-count{font-family:'DM Mono',monospace;font-size:10px;color:var(--ink3);white-space:nowrap}
.topbar-phase{display:flex;gap:6px}
.phase-tag{font-family:'DM Mono',monospace;font-size:9px;letter-spacing:.1em;text-transform:uppercase;padding:5px 10px;border-radius:2px;border:1px solid}
.phase-tag.p1{border-color:var(--blue);color:var(--blue)}
.phase-tag.p2{border-color:var(--oracle);color:var(--oracle)}

/* ── CONTENT AREA ── */
.content{padding:40px;max-width:820px}

/* ── PAGE HEADER ── */
.page-header{margin-bottom:40px}
.page-eyebrow{font-family:'DM Mono',monospace;font-size:9px;letter-spacing:.18em;text-transform:uppercase;color:var(--ink3);margin-bottom:12px;display:flex;align-items:center;gap:10px}
.page-eyebrow::before{content:'';display:inline-block;width:20px;height:1px;background:var(--ink3)}
.page-title{font-family:'Bitter',serif;font-size:36px;font-weight:700;color:var(--ink);line-height:1.15;letter-spacing:-.01em;margin-bottom:12px}
.page-sub{font-family:'Bitter',serif;font-style:italic;font-size:16px;color:var(--ink3);line-height:1.65;max-width:600px}

/* ── STEP SECTIONS ── */
.step-section{display:none;animation:fadeIn .3s ease both}
.step-section.visible{display:block}
@keyframes fadeIn{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}

/* ── STEP CARD ── */
.step-card{background:var(--surface);border:1px solid var(--border);border-radius:var(--r);overflow:hidden;margin-bottom:20px}
.step-card-header{padding:20px 24px 16px;border-bottom:1px solid var(--border);display:flex;align-items:flex-start;gap:16px}
.step-badge{width:36px;height:36px;border-radius:4px;display:flex;align-items:center;justify-content:center;font-family:'DM Mono',monospace;font-size:12px;font-weight:500;flex-shrink:0}
.badge-p1{background:var(--blue-pale);color:var(--blue);border:1px solid var(--blue-border)}
.badge-p2{background:var(--oracle-pale);color:var(--oracle);border:1px solid var(--oracle-border)}
.step-header-text{flex:1}
.step-title{font-family:'Bitter',serif;font-size:18px;font-weight:700;color:var(--ink);margin-bottom:4px;line-height:1.3}
.step-subtitle{font-size:13px;color:var(--ink3);line-height:1.5}
.step-body{padding:20px 24px}

/* ── NAV PATH ── */
.nav-path{background:var(--surface2);border:1px solid var(--border);border-radius:4px;padding:10px 14px;margin-bottom:16px;display:flex;align-items:center;gap:6px;flex-wrap:wrap}
.nav-path-label{font-family:'DM Mono',monospace;font-size:9px;letter-spacing:.12em;text-transform:uppercase;color:var(--ink3);margin-right:4px}
.nav-path-item{font-family:'DM Mono',monospace;font-size:11px;color:var(--blue-lt);font-weight:500}
.nav-path-sep{color:var(--ink3);font-size:11px}

/* ── FIELD TABLE ── */
.field-table{width:100%;border-collapse:collapse;margin-bottom:16px;font-size:13px}
.field-table th{background:var(--ink);color:#E8E4DC;font-family:'DM Mono',monospace;font-size:9px;letter-spacing:.1em;text-transform:uppercase;padding:8px 12px;text-align:left;font-weight:500}
.field-table td{padding:9px 12px;border-bottom:1px solid var(--border);vertical-align:top;line-height:1.5}
.field-table tr:last-child td{border-bottom:none}
.field-table tr:nth-child(even) td{background:var(--surface2)}
.field-name{font-weight:600;color:var(--ink);white-space:nowrap}
.field-value{font-family:'DM Mono',monospace;font-size:11px;color:var(--blue-lt)}
.field-note{font-size:12px;color:var(--ink3)}
.field-required{color:var(--oracle);font-size:10px;font-family:'DM Mono',monospace;display:block;margin-top:2px}

/* ── CALLOUTS ── */
.callout{border-radius:4px;padding:12px 16px;margin-bottom:16px;display:flex;gap:12px}
.callout-icon{font-size:14px;flex-shrink:0;margin-top:1px}
.callout-content{flex:1}
.callout-title{font-family:'DM Mono',monospace;font-size:9px;letter-spacing:.12em;text-transform:uppercase;margin-bottom:5px;display:block;font-weight:500}
.callout-content p{font-size:13px;line-height:1.6;margin:0}
.c-warn{background:var(--warn-pale);border:1px solid var(--warn-border)}
.c-warn .callout-title{color:var(--warn)}
.c-info{background:var(--blue-pale);border:1px solid var(--blue-border)}
.c-info .callout-title{color:var(--blue)}
.c-trap{background:var(--oracle-pale);border:1px solid var(--oracle-border)}
.c-trap .callout-title{color:var(--oracle)}
.c-ok{background:var(--green-pale);border:1px solid var(--green-border)}
.c-ok .callout-title{color:var(--green)}
.c-gold{background:var(--gold-pale);border:1px solid var(--gold-border)}
.c-gold .callout-title{color:var(--gold)}

/* ── CODE / MONO BLOCK ── */
.mono-block{background:var(--ink);color:#C8C0AC;font-family:'DM Mono',monospace;font-size:12px;border-radius:4px;padding:14px 16px;margin-bottom:16px;line-height:1.7;overflow-x:auto}
.mono-comment{color:#5A5848}
.mono-key{color:#D4A017}
.mono-val{color:#7ABFDC}
.mono-op{color:#E87050}

/* ── CHECKPOINT ── */
.checkpoint{background:var(--green-pale);border:1px solid var(--green-border);border-radius:4px;padding:14px 18px;margin-bottom:16px}
.checkpoint-title{font-family:'DM Mono',monospace;font-size:9px;letter-spacing:.14em;text-transform:uppercase;color:var(--green);margin-bottom:8px;display:flex;align-items:center;gap:6px}
.checkpoint ul{padding-left:16px;font-size:13px;color:var(--ink2)}
.checkpoint li{margin-bottom:4px}

/* ── DEPENDENCY MAP ── */
.dep-map{background:var(--surface);border:1px solid var(--border);border-radius:var(--r);overflow:hidden;margin-bottom:20px}
.dep-map-header{background:var(--ink);padding:12px 20px}
.dep-map-header span{font-family:'DM Mono',monospace;font-size:9px;letter-spacing:.14em;text-transform:uppercase;color:#8A8470}
.dep-chain{display:flex;align-items:stretch;overflow-x:auto;padding:20px}
.dep-node{background:var(--surface2);border:1px solid var(--border);border-radius:4px;padding:10px 14px;min-width:110px;flex-shrink:0;text-align:center}
.dep-node.blocking{border-color:var(--oracle-border);background:var(--oracle-pale)}
.dep-node.phase2{border-color:var(--blue-border);background:var(--blue-pale)}
.dep-title{font-family:'DM Mono',monospace;font-size:9px;letter-spacing:.06em;color:var(--ink2);line-height:1.4;display:block;margin-bottom:3px}
.dep-node.blocking .dep-title{color:var(--oracle)}
.dep-node.phase2 .dep-title{color:var(--blue)}
.dep-num{font-family:'Bitter',serif;font-size:11px;font-weight:700;color:var(--ink3)}
.dep-arrow{display:flex;align-items:center;padding:0 6px;color:var(--border2);font-size:18px;flex-shrink:0}

/* ── ERROR TABLE ── */
.error-table{width:100%;border-collapse:collapse;font-size:13px;margin-bottom:16px}
.error-table th{background:var(--surface2);font-family:'DM Mono',monospace;font-size:9px;letter-spacing:.1em;text-transform:uppercase;padding:8px 12px;text-align:left;color:var(--ink3);border-bottom:2px solid var(--border2)}
.error-table td{padding:10px 12px;border-bottom:1px solid var(--border);vertical-align:top;line-height:1.5}
.error-table tr:last-child td{border-bottom:none}
.err-sym{color:var(--oracle);font-family:'DM Mono',monospace;font-size:11px;font-weight:500}
.err-res{color:var(--green);font-size:12px}

/* ── TABS (subledger) ── */
.tab-bar{display:flex;gap:0;border-bottom:2px solid var(--border);margin-bottom:24px;overflow-x:auto}
.tab-btn{padding:10px 18px;font-family:'DM Mono',monospace;font-size:10px;letter-spacing:.1em;text-transform:uppercase;color:var(--ink3);cursor:pointer;border:none;background:transparent;border-bottom:2px solid transparent;margin-bottom:-2px;white-space:nowrap;transition:all .18s}
.tab-btn:hover{color:var(--ink2);border-bottom-color:var(--border2)}
.tab-btn.active{color:var(--oracle);border-bottom-color:var(--oracle);font-weight:600}
.tab-btn.filtered-out{opacity:.3;pointer-events:none}
.tab-content{display:none}
.tab-content.active{display:block}

/* ── SLA BLOCK ── */
.sla-block{margin-bottom:24px}
.sla-block-header{background:var(--ink);padding:10px 16px;border-radius:4px 4px 0 0;display:flex;align-items:center;gap:10px}
.sla-block-header .sla-letter{font-family:'DM Mono',monospace;font-size:11px;background:var(--oracle);color:#fff;width:22px;height:22px;border-radius:2px;display:flex;align-items:center;justify-content:center;flex-shrink:0}
.sla-block-title{font-size:13px;font-weight:600;color:#E8E4DC}
.sla-block-body{background:var(--surface);border:1px solid var(--border);border-top:none;border-radius:0 0 4px 4px;padding:16px 18px}
.sla-block-body p{font-size:13px;color:var(--ink2);margin-bottom:10px;line-height:1.6}
.sla-block-body p:last-child{margin-bottom:0}
.sla-event-row{display:flex;gap:10px;margin-bottom:8px;align-items:flex-start}
.sla-event-class{font-family:'DM Mono',monospace;font-size:10px;background:var(--blue-pale);border:1px solid var(--blue-border);color:var(--blue);padding:2px 8px;border-radius:2px;white-space:nowrap;flex-shrink:0;margin-top:2px}
.sla-event-type{font-size:12px;color:var(--ink2)}
.condition-row{background:var(--surface2);border:1px solid var(--border);border-radius:3px;padding:8px 12px;margin-bottom:6px;font-family:'DM Mono',monospace;font-size:11px;color:var(--blue-lt);display:flex;align-items:center;gap:10px}
.condition-op{color:var(--oracle);font-weight:500}

/* ── NAMING GUIDE ── */
.naming-grid{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:16px}
@media(max-width:600px){.naming-grid{grid-template-columns:1fr}}
.naming-item{background:var(--surface);border:1px solid var(--border);border-radius:4px;padding:12px 14px}
.naming-item h4{font-family:'DM Mono',monospace;font-size:9px;letter-spacing:.1em;text-transform:uppercase;color:var(--ink3);margin-bottom:6px}
.naming-item .pattern{font-family:'DM Mono',monospace;font-size:12px;color:var(--blue-lt);margin-bottom:4px}
.naming-item .example{font-size:12px;color:var(--ink3)}
.naming-item .example span{font-family:'DM Mono',monospace;font-size:11px;color:var(--green-lt)}

/* ── STEP NAV ── */
.step-nav{display:flex;justify-content:space-between;align-items:center;margin-top:28px;padding-top:20px;border-top:1px solid var(--border)}
.btn{padding:10px 22px;border-radius:3px;cursor:pointer;font-family:'DM Mono',monospace;font-size:10px;letter-spacing:.1em;text-transform:uppercase;transition:all .18s;border:1px solid;display:flex;align-items:center;gap:6px}
.btn-outline{background:transparent;border-color:var(--border2);color:var(--ink3)}
.btn-outline:hover{border-color:var(--ink3);color:var(--ink)}
.btn-primary{background:var(--ink);border-color:var(--ink);color:#E8E0CC}
.btn-primary:hover{background:#2A2820}
.btn-oracle{background:var(--oracle);border-color:var(--oracle);color:#fff}
.btn-oracle:hover{background:var(--oracle-lt)}
.btn:disabled{opacity:.35;cursor:not-allowed}
.btn-complete{background:var(--green);border-color:var(--green);color:#fff}
.btn-complete:hover{background:var(--green-lt)}

/* ── INTRO PANEL ── */
.intro-panel{background:var(--surface);border:1px solid var(--border);border-radius:var(--r);padding:28px;margin-bottom:28px}
.intro-grid{display:grid;grid-template-columns:1fr 1fr;gap:20px;margin-top:20px}
@media(max-width:600px){.intro-grid{grid-template-columns:1fr}}
.intro-item{border:1px solid var(--border);border-radius:4px;padding:14px}
.intro-item-num{font-family:'DM Mono',monospace;font-size:11px;color:var(--ink3);margin-bottom:5px;display:block}
.intro-item-title{font-family:'Bitter',serif;font-size:15px;font-weight:700;color:var(--ink);margin-bottom:4px}
.intro-item-desc{font-size:12px;color:var(--ink3);line-height:1.5}
.intro-item.phase1{border-left:3px solid var(--blue)}
.intro-item.phase2{border-left:3px solid var(--oracle)}

/* ── SELECTED FILTERS BANNER ── */
.filter-banner{background:var(--gold-pale);border:1px solid var(--gold-border);border-radius:4px;padding:10px 14px;margin-bottom:20px;font-size:12px;color:var(--gold);display:flex;align-items:center;gap:8px}
.filter-banner strong{font-family:'DM Mono',monospace;font-size:9px;letter-spacing:.1em;text-transform:uppercase}

/* Typography */
h2{font-family:'Bitter',serif;font-size:22px;font-weight:700;color:var(--ink);margin-bottom:14px;letter-spacing:-.01em}
h3{font-family:'Barlow',sans-serif;font-size:15px;font-weight:700;color:var(--ink);margin-bottom:10px}
p{color:var(--ink2);line-height:1.65;margin-bottom:12px}
p:last-child{margin-bottom:0}
ul,ol{padding-left:18px;color:var(--ink2);font-size:14px}
li{margin-bottom:5px;line-height:1.55}
code{font-family:'DM Mono',monospace;font-size:11px;background:var(--surface2);color:var(--blue-lt);padding:1px 5px;border-radius:2px;border:1px solid var(--border)}
strong{color:var(--ink);font-weight:600}
</style>
</head>
<body>
<div class="shell">

<!-- ═══════════════════════════════════════════════════════════
     SIDEBAR
═══════════════════════════════════════════════════════════ -->
<nav class="sidebar" id="sidebar">
  <div class="sidebar-brand">
    <div class="brand-label">Oracle Fusion Cloud ERP</div>
    <div class="brand-title">Secondary Ledger<br>Configuration Guide</div>
  </div>

  <div class="nav-section">
    <div class="nav-section-label"><span class="nav-phase-dot dot-p1"></span>Phase 1 — Base Setup</div>
    <div class="nav-item active" onclick="showStep('intro')" id="nav-intro">
      <span class="nav-num">—</span><span class="nav-text">Overview &amp; Dependencies</span>
    </div>
    <div class="nav-item" onclick="showStep('s1')" id="nav-s1">
      <span class="nav-num">01</span><span class="nav-text">Create Secondary Ledger</span>
    </div>
    <div class="nav-item" onclick="showStep('s2')" id="nav-s2">
      <span class="nav-num">02</span><span class="nav-text">Set Conversion Level</span>
    </div>
    <div class="nav-item" onclick="showStep('s3')" id="nav-s3">
      <span class="nav-num">03</span><span class="nav-text">Build CoA Mapping Set</span>
    </div>
    <div class="nav-item" onclick="showStep('s4')" id="nav-s4">
      <span class="nav-num">04</span><span class="nav-text">Assign Mapping Set</span>
    </div>
    <div class="nav-item" onclick="showStep('s5')" id="nav-s5">
      <span class="nav-num">05</span><span class="nav-text">Create Secondary SLAM</span>
    </div>
    <div class="nav-item" onclick="showStep('s6')" id="nav-s6">
      <span class="nav-num">06</span><span class="nav-text">Open Period &amp; Close Monitor</span>
    </div>
    <div class="nav-item" onclick="showStep('s7')" id="nav-s7">
      <span class="nav-num">07</span><span class="nav-text">Validate — Draft Run</span>
    </div>
    <div class="nav-item" onclick="showStep('s8')" id="nav-s8">
      <span class="nav-num">08</span><span class="nav-text">Naming Convention Guide</span>
    </div>
  </div>

  <div class="nav-section">
    <div class="nav-section-label"><span class="nav-phase-dot dot-p2"></span>Phase 2 — SLA Rules</div>
    <div class="nav-item" onclick="showStep('p2intro')" id="nav-p2intro">
      <span class="nav-num">—</span><span class="nav-text">SLA Rule Framework</span>
    </div>
    <div class="nav-item" onclick="showStep('sla-gl')" id="nav-sla-gl">
      <span class="nav-num">GL</span><span class="nav-text">General Ledger</span>
    </div>
    <div class="nav-item" onclick="showStep('sla-ap')" id="nav-sla-ap">
      <span class="nav-num">AP</span><span class="nav-text">Accounts Payable</span>
    </div>
    <div class="nav-item" onclick="showStep('sla-ar')" id="nav-sla-ar">
      <span class="nav-num">AR</span><span class="nav-text">Accounts Receivable</span>
    </div>
    <div class="nav-item" onclick="showStep('sla-fa')" id="nav-sla-fa">
      <span class="nav-num">FA</span><span class="nav-text">Fixed Assets</span>
    </div>
    <div class="nav-item" onclick="showStep('sla-cost')" id="nav-sla-cost">
      <span class="nav-num">CA</span><span class="nav-text">Cost Accounting</span>
    </div>
    <div class="nav-item" onclick="showStep('sla-proj')" id="nav-sla-proj">
      <span class="nav-num">PJ</span><span class="nav-text">Projects</span>
    </div>
    <div class="nav-item" onclick="showStep('errors')" id="nav-errors">
      <span class="nav-num">!</span><span class="nav-text">Common Errors</span>
    </div>
  </div>

  <div class="sidebar-filter">
    <span class="filter-label">Filter by subledger</span>
    <div class="filter-chips">
      <div class="chip active" data-filter="gl" onclick="toggleFilter(this)">GL</div>
      <div class="chip active" data-filter="ap" onclick="toggleFilter(this)">AP</div>
      <div class="chip active" data-filter="ar" onclick="toggleFilter(this)">AR</div>
      <div class="chip active" data-filter="fa" onclick="toggleFilter(this)">FA</div>
      <div class="chip active" data-filter="cost" onclick="toggleFilter(this)">Cost</div>
      <div class="chip active" data-filter="proj" onclick="toggleFilter(this)">Projects</div>
    </div>
  </div>
</nav>

<!-- ═══════════════════════════════════════════════════════════
     MAIN
═══════════════════════════════════════════════════════════ -->
<main class="main">
  <div class="topbar">
    <div class="topbar-progress">
      <span class="tp-label">Progress</span>
      <div class="progress-track"><div class="progress-fill" id="progressFill" style="width:0%"></div></div>
      <span class="tp-count" id="progressCount">0 / 15</span>
    </div>
    <div class="topbar-phase">
      <span class="phase-tag p1">Phase 1: Base Setup</span>
      <span class="phase-tag p2">Phase 2: SLA Rules</span>
    </div>
  </div>

  <div class="content">

    <!-- ══════════ INTRO ══════════ -->
    <div class="step-section visible" id="step-intro">
      <div class="page-header">
        <div class="page-eyebrow">Configuration Guide</div>
        <h1 class="page-title">Secondary Ledger<br>Setup — End to End</h1>
        <p class="page-sub">Two phases. Eight base setup steps that apply to every secondary ledger, followed by SLA rule authoring per subledger. Complete Phase 1 before beginning Phase 2.</p>
      </div>

      <div class="intro-panel">
        <h2>What This Guide Covers</h2>
        <p>Secondary ledger configuration in Oracle Fusion has two distinct phases. The base setup (Phase 1) creates the ledger infrastructure — the ledger object itself, the chart of accounts mapping, and the Subledger Accounting Method. The SLA rule authoring (Phase 2) defines how transactions are accounted differently in the secondary ledger, per subledger application. Phase 1 must be complete and validated before any Phase 2 work begins.</p>
        <div class="intro-grid">
          <div class="intro-item phase1">
            <span class="intro-item-num">Phase 1 · Steps 1–8</span>
            <div class="intro-item-title">Base Setup</div>
            <div class="intro-item-desc">Ledger creation, conversion level, CoA mapping, SLAM assignment, period management, draft validation. Required for every secondary ledger regardless of use case.</div>
          </div>
          <div class="intro-item phase1">
            <span class="intro-item-num">~2–4 days (greenfield)</span>
            <div class="intro-item-title">Effort Estimate</div>
            <div class="intro-item-desc">Assuming CoA is already defined. Add 1–2 days if CoA mapping set needs to be built from scratch across a complex segment structure.</div>
          </div>
          <div class="intro-item phase2">
            <span class="intro-item-num">Phase 2 · Per subledger</span>
            <div class="intro-item-title">SLA Rule Authoring</div>
            <div class="intro-item-desc">Journal Line Rules, Account Derivation Rules, Journal Entry Rules, and SLAM assembly per subledger. Effort varies by use case complexity and number of accounting differences.</div>
          </div>
          <div class="intro-item phase2">
            <span class="intro-item-num">3–15 days per subledger</span>
            <div class="intro-item-title">Effort Estimate</div>
            <div class="intro-item-desc">Simple AP/AR rules (2–3 differences): 3–5 days. Complex FA component accounting or Cost Accounting dual-policy: 8–15 days including testing.</div>
          </div>
        </div>
      </div>

      <div class="dep-map">
        <div class="dep-map-header"><span>Dependency Chain — Steps Must Be Completed in This Order</span></div>
        <div class="dep-chain">
          <div class="dep-node blocking"><span class="dep-title">Create Secondary Ledger</span><span class="dep-num">Step 1</span></div>
          <div class="dep-arrow">→</div>
          <div class="dep-node blocking"><span class="dep-title">Set Conversion Level</span><span class="dep-num">Step 2</span></div>
          <div class="dep-arrow">→</div>
          <div class="dep-node blocking"><span class="dep-title">CoA Mapping Set</span><span class="dep-num">Step 3</span></div>
          <div class="dep-arrow">→</div>
          <div class="dep-node blocking"><span class="dep-title">Assign Mapping</span><span class="dep-num">Step 4</span></div>
          <div class="dep-arrow">→</div>
          <div class="dep-node blocking"><span class="dep-title">Create SLAM</span><span class="dep-num">Step 5</span></div>
          <div class="dep-arrow">→</div>
          <div class="dep-node blocking"><span class="dep-title">Open Period</span><span class="dep-num">Step 6</span></div>
          <div class="dep-arrow">→</div>
          <div class="dep-node"><span class="dep-title">Draft Validate</span><span class="dep-num">Step 7</span></div>
          <div class="dep-arrow">→</div>
          <div class="dep-node phase2"><span class="dep-title">SLA Rules (Phase 2)</span><span class="dep-num">Per subledger</span></div>
        </div>
      </div>

      <div class="callout c-trap">
        <span class="callout-icon">⚠</span>
        <div class="callout-content">
          <span class="callout-title">Hard Blocking Dependencies</span>
          <p>The steps marked in the dependency chain above are blocking — each must be complete before the next begins. The most common cause of rework is attempting SLA rule authoring (Phase 2) before the secondary SLAM is assigned and the period is open. SLA rules that reference a SLAM not yet assigned to a ledger will not fire during Create Accounting.</p>
        </div>
      </div>

      <div class="step-nav">
        <button class="btn btn-outline" disabled>← Previous</button>
        <button class="btn btn-primary" onclick="showStep('s1')">Begin Phase 1 → Step 1</button>
      </div>
    </div>

    <!-- ══════════ STEP 1: Create Secondary Ledger ══════════ -->
    <div class="step-section" id="step-s1">
      <div class="step-card">
        <div class="step-card-header">
          <div class="step-badge badge-p1">01</div>
          <div class="step-header-text">
            <div class="step-title">Create the Secondary Ledger</div>
            <div class="step-subtitle">Establish the ledger object and assign its four defining properties</div>
          </div>
        </div>
        <div class="step-body">
          <div class="nav-path">
            <span class="nav-path-label">Path</span>
            <span class="nav-path-item">Setup and Maintenance</span>
            <span class="nav-path-sep">›</span>
            <span class="nav-path-item">Manage Accounting Configurations</span>
            <span class="nav-path-sep">›</span>
            <span class="nav-path-item">Ledgers</span>
            <span class="nav-path-sep">›</span>
            <span class="nav-path-item">Create</span>
          </div>

          <table class="field-table">
            <thead><tr><th>Field</th><th>Value / Setting</th><th>Notes</th></tr></thead>
            <tbody>
              <tr><td class="field-name">Ledger Name<span class="field-required">Required</span></td><td class="field-value">[ENTITY]_[STANDARD]_SEC<br>e.g. UK_UKGAAP_SEC</td><td class="field-note">Follow naming convention — see Step 8. The name cannot be changed after transactions are posted.</td></tr>
              <tr><td class="field-name">Ledger Category<span class="field-required">Required</span></td><td class="field-value">Secondary</td><td class="field-note">Must be set to Secondary. Primary is the default — easy to miss.</td></tr>
              <tr><td class="field-name">Chart of Accounts<span class="field-required">Required</span></td><td class="field-value">Local statutory CoA OR same as primary</td><td class="field-note">If different from primary — Step 3 (CoA Mapping Set) is mandatory. If same — mapping set is simpler but still required if segment values differ.</td></tr>
              <tr><td class="field-name">Accounting Calendar<span class="field-required">Required</span></td><td class="field-value">Typically same as primary</td><td class="field-note">Calendar can differ but period open/close must then be managed independently. Misaligned calendars are a common source of inter-ledger timing differences.</td></tr>
              <tr><td class="field-name">Currency<span class="field-required">Required</span></td><td class="field-value">Functional currency of statutory entity</td><td class="field-note">Can be different from primary. If different, exchange rate settings apply. Most statutory secondary ledgers use the same functional currency as primary.</td></tr>
              <tr><td class="field-name">Subledger Accounting Method<span class="field-required">Required — assign after Step 5</span></td><td class="field-value">Leave blank initially. Assign after creating SLAM in Step 5.</td><td class="field-note">Do not assign a SLAM at creation time unless it already exists. Assigning the default Standard Accrual here and forgetting to update it is the most common setup error.</td></tr>
              <tr><td class="field-name">Legal Entity Assignment<span class="field-required">Required</span></td><td class="field-value">Same Legal Entity as the primary ledger</td><td class="field-note">A secondary ledger must be linked to the same Legal Entity as its primary. The Legal Entity determines which transactions flow into the secondary.</td></tr>
            </tbody>
          </table>

          <div class="callout c-trap">
            <span class="callout-icon">⚠</span>
            <div class="callout-content">
              <span class="callout-title">Do Not Assign the Default SLAM Now</span>
              <p>If you assign <code>Standard Accrual</code> as the SLAM at creation and forget to update it in Step 5, the secondary ledger will silently produce entries identical to the primary. This is discovered at UAT — after significant SLA rule authoring effort — when the secondary entries look wrong. Leave the SLAM field blank or note it clearly for Step 5.</p>
            </div>
          </div>

          <div class="callout c-info">
            <span class="callout-icon">ℹ</span>
            <div class="callout-content">
              <span class="callout-title">Post-Go-Live Addition</span>
              <p>If you are adding a secondary ledger to a live primary, the creation steps are identical. The additional consideration is the activation date — the secondary ledger will only capture accounting from the first period it is open. Historical balance migration must be planned separately. See the Common Errors section for guidance.</p>
            </div>
          </div>

          <div class="checkpoint">
            <div class="checkpoint-title">✓ Step 1 Checkpoint</div>
            <ul>
              <li>Ledger Category = Secondary confirmed</li>
              <li>Ledger name follows naming convention</li>
              <li>CoA assigned (same or different from primary — documented)</li>
              <li>Legal Entity assigned and confirmed</li>
              <li>SLAM field left blank (will be assigned in Step 5)</li>
            </ul>
          </div>
        </div>
      </div>
      <div class="step-nav">
        <button class="btn btn-outline" onclick="showStep('intro')">← Overview</button>
        <button class="btn btn-primary" onclick="showStep('s2')">Step 2: Conversion Level →</button>
      </div>
    </div>

    <!-- ══════════ STEP 2: Conversion Level ══════════ -->
    <div class="step-section" id="step-s2">
      <div class="step-card">
        <div class="step-card-header">
          <div class="step-badge badge-p1">02</div>
          <div class="step-header-text">
            <div class="step-title">Set the Conversion Level</div>
            <div class="step-subtitle">The most consequential configuration decision — determines how far the secondary diverges from the primary</div>
          </div>
        </div>
        <div class="step-body">
          <div class="nav-path">
            <span class="nav-path-label">Path</span>
            <span class="nav-path-item">Manage Accounting Configurations</span>
            <span class="nav-path-sep">›</span>
            <span class="nav-path-item">Secondary Ledger</span>
            <span class="nav-path-sep">›</span>
            <span class="nav-path-item">Ledger Options</span>
            <span class="nav-path-sep">›</span>
            <span class="nav-path-item">Conversion Level</span>
          </div>

          <table class="field-table">
            <thead><tr><th>Level</th><th>When to Use</th><th>SLA Rules Required?</th><th>Typical Use Cases</th></tr></thead>
            <tbody>
              <tr><td class="field-name">Subledger</td><td class="field-note">Accounting rules differ at transaction level — different account derivation, amounts, or event handling</td><td class="field-value">Yes — JLRs + ADRs per subledger</td><td class="field-note">Statutory reporting, FA component accounting, Cost dual-policy, IFRS 16, IFRS 9, Projects, Intercompany, IAS 29</td></tr>
              <tr><td class="field-name">Journal</td><td class="field-note">Subledger entries identical; differences only arise at GL journal stage</td><td class="field-value">Partial — GL journal rules only</td><td class="field-note">Management overlay adjustments, allocation differences, rare statutory scenarios</td></tr>
              <tr><td class="field-name">Balance</td><td class="field-note">Secondary needs same entries as primary; period-end balance adjustments only</td><td class="field-value">Minimal</td><td class="field-note">Simplified group balance reporting. Rarely the right choice for statutory — verify carefully</td></tr>
              <tr><td class="field-name">Adjustment Only</td><td class="field-note">No automatic transfer from primary; all entries are manual journals</td><td class="field-value">None (manual journals only)</td><td class="field-note">Pre-consolidation staging (Use Case 12), goodwill amortisation, management overlay</td></tr>
            </tbody>
          </table>

          <div class="callout c-trap">
            <span class="callout-icon">⚠</span>
            <div class="callout-content">
              <span class="callout-title">The Most Common Implementation Error</span>
              <p>Teams choose <strong>Balance</strong> because it is simplest to configure, then discover at UAT that the secondary ledger produces no transaction-level differences. Changing conversion level after SLA rules are authored requires significant rework — the rules must be reassigned to a different event processing framework. Always confirm conversion level against your specific use cases before proceeding to Step 3. If any of the 13 use cases from the secondary ledger guide apply, <strong>Subledger is almost certainly required</strong>.</p>
            </div>
          </div>

          <div class="callout c-warn">
            <span class="callout-icon">⚡</span>
            <div class="callout-content">
              <span class="callout-title">Conversion Level Cannot Be Changed Post-Transaction</span>
              <p>Once transactions have been processed through a secondary ledger, the conversion level is effectively locked. Changing it requires reversing all processed accounting, reconfiguring, and reprocessing. Treat this as a one-way decision — validate before proceeding.</p>
            </div>
          </div>

          <div class="checkpoint">
            <div class="checkpoint-title">✓ Step 2 Checkpoint</div>
            <ul>
              <li>Conversion level confirmed with finance team (not defaulted)</li>
              <li>If Subledger: SLA rule authoring scope agreed and documented before proceeding</li>
              <li>If Balance: explicit confirmation that transaction-level differences are not required</li>
              <li>If Adjustment Only: manual journal process designed and owners assigned</li>
            </ul>
          </div>
        </div>
      </div>
      <div class="step-nav">
        <button class="btn btn-outline" onclick="showStep('s1')">← Step 1</button>
        <button class="btn btn-primary" onclick="showStep('s3')">Step 3: CoA Mapping →</button>
      </div>
    </div>

    <!-- ══════════ STEP 3: CoA Mapping ══════════ -->
    <div class="step-section" id="step-s3">
      <div class="step-card">
        <div class="step-card-header">
          <div class="step-badge badge-p1">03</div>
          <div class="step-header-text">
            <div class="step-title">Build the CoA Mapping Set</div>
            <div class="step-subtitle">Define how primary CoA segments translate to secondary CoA segments</div>
          </div>
        </div>
        <div class="step-body">
          <div class="nav-path">
            <span class="nav-path-label">Path</span>
            <span class="nav-path-item">Setup and Maintenance</span>
            <span class="nav-path-sep">›</span>
            <span class="nav-path-item">Manage Chart of Accounts Mappings</span>
            <span class="nav-path-sep">›</span>
            <span class="nav-path-item">Create</span>
          </div>

          <p>A CoA Mapping Set defines how each segment value in the primary chart of accounts maps to a corresponding segment value in the secondary chart of accounts. Even when the primary and secondary share the same CoA, a mapping set is required if conversion level is Subledger — it defines the default account derivation before SLA rules override specific lines.</p>

          <table class="field-table">
            <thead><tr><th>Field</th><th>Value / Setting</th><th>Notes</th></tr></thead>
            <tbody>
              <tr><td class="field-name">Mapping Set Name</td><td class="field-value">[ENTITY]_[FROM_COA]_TO_[TO_COA]</td><td class="field-note">e.g. UK_CORP_TO_UKGAAP. Use the naming convention — see Step 8.</td></tr>
              <tr><td class="field-name">Source Chart of Accounts</td><td class="field-value">Primary ledger CoA</td><td class="field-note">The "from" side — primary CoA segment values.</td></tr>
              <tr><td class="field-name">Target Chart of Accounts</td><td class="field-value">Secondary ledger CoA</td><td class="field-note">The "to" side — statutory CoA segment values.</td></tr>
              <tr><td class="field-name">Segment Mapping Rules</td><td class="field-value">One rule per segment pair</td><td class="field-note">Define for each segment: Natural Account, Company, Cost Center, Intercompany. Use Rollup for many-to-one. Use Account Rules for exceptions.</td></tr>
            </tbody>
          </table>

          <h3>Mapping Rule Types</h3>
          <div class="callout c-info">
            <span class="callout-icon">ℹ</span>
            <div class="callout-content">
              <span class="callout-title">Rollup vs Account Rules</span>
              <p><strong>Rollup mapping:</strong> Maps a range of source segment values to a single target value. Use when multiple primary accounts roll into one local statutory account — e.g., primary accounts 5100–5199 (all operating expenses) map to local GAAP account 7000.<br><br>
              <strong>Account rules:</strong> Define specific source-to-target account pairs, with conditions. Use for exceptions — specific accounts that need individual mapping different from the range rule. Account rules take priority over rollup rules when both apply to the same source value.</p>
            </div>
          </div>

          <div class="mono-block">
<span class="mono-comment">-- Example: Segment mapping logic</span>
<span class="mono-comment">-- Natural Account segment — rollup approach</span>
<span class="mono-key">Primary Account Range</span> <span class="mono-op">→</span> <span class="mono-val">Secondary Account</span>
5100 - 5199  <span class="mono-op">→</span>  <span class="mono-val">7000</span>  <span class="mono-comment">-- Operating expense (rollup)</span>
6000 - 6099  <span class="mono-op">→</span>  <span class="mono-val">8100</span>  <span class="mono-comment">-- Finance costs (rollup)</span>
1200         <span class="mono-op">→</span>  <span class="mono-val">3200</span>  <span class="mono-comment">-- AR trade (account rule exception)</span>
1900         <span class="mono-op">→</span>  <span class="mono-val">2800</span>  <span class="mono-comment">-- Provision (account rule exception)</span>

<span class="mono-comment">-- Company segment — direct 1:1 (same structure)</span>
<span class="mono-key">Primary</span> <span class="mono-op">→</span> <span class="mono-val">Secondary</span>
UK01    <span class="mono-op">→</span>  <span class="mono-val">UK01</span>   <span class="mono-comment">-- Same value, direct pass-through</span>
          </div>

          <div class="callout c-trap">
            <span class="callout-icon">⚠</span>
            <div class="callout-content">
              <span class="callout-title">Unmapped Accounts Post to Suspense</span>
              <p>Any primary account combination that is not covered by a mapping rule will fail Create Accounting or post to the secondary ledger's suspense account. Run Create Accounting in Draft mode after building the mapping set and review the output for any suspense postings before proceeding. 100% mapping coverage of active account combinations is a Phase 1 exit criterion.</p>
            </div>
          </div>

          <div class="checkpoint">
            <div class="checkpoint-title">✓ Step 3 Checkpoint</div>
            <ul>
              <li>Mapping set created and named correctly</li>
              <li>All active primary account combinations covered by a rollup or account rule</li>
              <li>Draft Create Accounting run — zero suspense postings confirmed</li>
              <li>Exceptions documented (accounts requiring specific SLA ADR overrides in Phase 2)</li>
            </ul>
          </div>
        </div>
      </div>
      <div class="step-nav">
        <button class="btn btn-outline" onclick="showStep('s2')">← Step 2</button>
        <button class="btn btn-primary" onclick="showStep('s4')">Step 4: Assign Mapping →</button>
      </div>
    </div>

    <!-- ══════════ STEP 4: Assign Mapping Set ══════════ -->
    <div class="step-section" id="step-s4">
      <div class="step-card">
        <div class="step-card-header">
          <div class="step-badge badge-p1">04</div>
          <div class="step-header-text">
            <div class="step-title">Assign the Mapping Set to the Secondary Ledger</div>
            <div class="step-subtitle">Link the CoA Mapping Set to the secondary ledger in Accounting Configurations</div>
          </div>
        </div>
        <div class="step-body">
          <div class="nav-path">
            <span class="nav-path-label">Path</span>
            <span class="nav-path-item">Manage Accounting Configurations</span>
            <span class="nav-path-sep">›</span>
            <span class="nav-path-item">Secondary Ledger</span>
            <span class="nav-path-sep">›</span>
            <span class="nav-path-item">Mapping</span>
            <span class="nav-path-sep">›</span>
            <span class="nav-path-item">Assign Chart of Accounts Mapping</span>
          </div>

          <p>The mapping set built in Step 3 must be explicitly linked to the secondary ledger. Without this assignment, Create Accounting does not know which mapping rules to apply when converting primary accounts to secondary accounts.</p>

          <table class="field-table">
            <thead><tr><th>Field</th><th>Value</th><th>Notes</th></tr></thead>
            <tbody>
              <tr><td class="field-name">Secondary Ledger</td><td class="field-value">The ledger created in Step 1</td><td class="field-note">Select from the list of secondary ledgers associated with this primary.</td></tr>
              <tr><td class="field-name">Chart of Accounts Mapping</td><td class="field-value">The mapping set built in Step 3</td><td class="field-note">Select the mapping set by name. Confirm source and target CoA are displayed correctly in the summary.</td></tr>
              <tr><td class="field-name">Effective Date</td><td class="field-value">First period open date for the secondary ledger</td><td class="field-note">Mapping is effective from this date. For post-go-live additions, align to the secondary ledger activation date.</td></tr>
            </tbody>
          </table>

          <div class="callout c-warn">
            <span class="callout-icon">⚡</span>
            <div class="callout-content">
              <span class="callout-title">Validate After Assignment</span>
              <p>After assigning the mapping set, navigate back to the secondary ledger configuration and confirm the mapping set name is displayed in the Mapping section. A common UI issue causes the assignment to appear saved but not persist — always verify.</p>
            </div>
          </div>

          <div class="checkpoint">
            <div class="checkpoint-title">✓ Step 4 Checkpoint</div>
            <ul>
              <li>Mapping set displayed in secondary ledger Mapping section</li>
              <li>Source CoA = primary ledger CoA confirmed</li>
              <li>Target CoA = secondary ledger CoA confirmed</li>
              <li>Effective date aligned to secondary ledger first period</li>
            </ul>
          </div>
        </div>
      </div>
      <div class="step-nav">
        <button class="btn btn-outline" onclick="showStep('s3')">← Step 3</button>
        <button class="btn btn-primary" onclick="showStep('s5')">Step 5: Create SLAM →</button>
      </div>
    </div>

    <!-- ══════════ STEP 5: Create SLAM ══════════ -->
    <div class="step-section" id="step-s5">
      <div class="step-card">
        <div class="step-card-header">
          <div class="step-badge badge-p1">05</div>
          <div class="step-header-text">
            <div class="step-title">Create and Assign the Secondary SLAM</div>
            <div class="step-subtitle">The Subledger Accounting Method that drives all accounting differences in the secondary ledger</div>
          </div>
        </div>
        <div class="step-body">
          <div class="nav-path">
            <span class="nav-path-label">Path</span>
            <span class="nav-path-item">Setup and Maintenance</span>
            <span class="nav-path-sep">›</span>
            <span class="nav-path-item">Manage Subledger Accounting Methods</span>
            <span class="nav-path-sep">›</span>
            <span class="nav-path-item">Create</span>
          </div>

          <p>The SLAM is the container that holds all SLA rules for the secondary ledger. Creating a dedicated secondary SLAM — rather than sharing the primary SLAM — is mandatory. Sharing the primary SLAM means the secondary ledger cannot have different accounting rules, which defeats its purpose.</p>

          <table class="field-table">
            <thead><tr><th>Field</th><th>Value / Setting</th><th>Notes</th></tr></thead>
            <tbody>
              <tr><td class="field-name">Name</td><td class="field-value">[ENTITY]_[STANDARD]_SLAM<br>e.g. UK_UKGAAP_SLAM</td><td class="field-note">Follow naming convention. SLAM name appears in Create Accounting logs — make it identifiable.</td></tr>
              <tr><td class="field-name">Chart of Accounts</td><td class="field-value">Secondary ledger CoA</td><td class="field-note">Must match the CoA assigned to the secondary ledger in Step 1. Mismatch causes Create Accounting errors.</td></tr>
              <tr><td class="field-name">Description</td><td class="field-value">Describe scope: subledgers, use cases, effective date</td><td class="field-note">This is the primary documentation point for the SLAM. Include which use cases (from the 13) this SLAM handles.</td></tr>
              <tr><td class="field-name">Journal Entry Rules (JERs)</td><td class="field-value">Added in Phase 2</td><td class="field-note">The SLAM is initially empty. Phase 2 adds JERs per subledger application and event class.</td></tr>
            </tbody>
          </table>

          <h3>Assigning the SLAM to the Secondary Ledger</h3>
          <div class="nav-path">
            <span class="nav-path-label">Path</span>
            <span class="nav-path-item">Manage Accounting Configurations</span>
            <span class="nav-path-sep">›</span>
            <span class="nav-path-item">Secondary Ledger</span>
            <span class="nav-path-sep">›</span>
            <span class="nav-path-item">Ledger Options</span>
            <span class="nav-path-sep">›</span>
            <span class="nav-path-item">Subledger Accounting Method</span>
          </div>
          <p>Return to the secondary ledger created in Step 1 and set the Subledger Accounting Method field to the SLAM just created. Save and confirm the SLAM name is displayed correctly in the ledger summary.</p>

          <div class="callout c-trap">
            <span class="callout-icon">⚠</span>
            <div class="callout-content">
              <span class="callout-title">Never Share the Primary SLAM</span>
              <p>Assigning the primary ledger's SLAM to the secondary ledger will cause the secondary to produce identical accounting entries to the primary. All SLA rules in the primary SLAM apply equally to both ledgers. This is the most common reason secondary ledgers appear to "work" in Phase 1 but produce no value in testing. Always create a new, dedicated SLAM for the secondary ledger.</p>
            </div>
          </div>

          <div class="callout c-gold">
            <span class="callout-icon">💡</span>
            <div class="callout-content">
              <span class="callout-title">SLAM Inheritance Pattern</span>
              <p>You can create the secondary SLAM by copying the primary SLAM as a starting point, then modifying only the rules that differ. This is efficient when the secondary ledger shares most accounting rules with the primary and only overrides a subset. Use <strong>Manage Subledger Accounting Methods &gt; Duplicate</strong> and rename the copy before modifying.</p>
            </div>
          </div>

          <div class="checkpoint">
            <div class="checkpoint-title">✓ Step 5 Checkpoint</div>
            <ul>
              <li>Secondary SLAM created with correct name and description</li>
              <li>SLAM CoA matches secondary ledger CoA</li>
              <li>SLAM assigned to secondary ledger in Accounting Configurations</li>
              <li>Primary SLAM and secondary SLAM are confirmed as separate objects</li>
            </ul>
          </div>
        </div>
      </div>
      <div class="step-nav">
        <button class="btn btn-outline" onclick="showStep('s4')">← Step 4</button>
        <button class="btn btn-primary" onclick="showStep('s6')">Step 6: Open Period →</button>
      </div>
    </div>

    <!-- ══════════ STEP 6: Period & Close Monitor ══════════ -->
    <div class="step-section" id="step-s6">
      <div class="step-card">
        <div class="step-card-header">
          <div class="step-badge badge-p1">06</div>
          <div class="step-header-text">
            <div class="step-title">Open Period &amp; Activate Close Monitor</div>
            <div class="step-subtitle">The secondary period must be open before any Create Accounting run — the single most common operational error</div>
          </div>
        </div>
        <div class="step-body">
          <div class="nav-path">
            <span class="nav-path-label">Period Open Path</span>
            <span class="nav-path-item">General Ledger</span>
            <span class="nav-path-sep">›</span>
            <span class="nav-path-item">Accounting</span>
            <span class="nav-path-sep">›</span>
            <span class="nav-path-item">Manage Accounting Periods</span>
          </div>

          <table class="field-table">
            <thead><tr><th>Action</th><th>Detail</th><th>Notes</th></tr></thead>
            <tbody>
              <tr><td class="field-name">Select secondary ledger</td><td class="field-note">Choose the secondary ledger from the ledger selector — not the primary</td><td class="field-note">Period management is per ledger. Switching between ledgers in the UI is required — you cannot open primary and secondary periods simultaneously from a single screen.</td></tr>
              <tr><td class="field-name">Open the period</td><td class="field-note">Set status from Future to Open</td><td class="field-note">The period must match the period you intend to process in Create Accounting. If primary period 2024-Dec is open, the secondary ledger must also have 2024-Dec open.</td></tr>
              <tr><td class="field-name">Verify subledger periods</td><td class="field-note">Each subledger application (AP, AR, FA, Cost) has its own period status</td><td class="field-note">Navigate to each subledger and confirm its period is also open for the secondary ledger. Subledger period status is independent of GL period status.</td></tr>
            </tbody>
          </table>

          <div class="callout c-trap">
            <span class="callout-icon">⚠</span>
            <div class="callout-content">
              <span class="callout-title">Automate Period Open — Do Not Leave It as a Checklist Item</span>
              <p>If Create Accounting runs before the secondary ledger period is open, the primary ledger receives accounting but the secondary does not. Recovery requires identifying all unaccounted transactions for the secondary, opening the period retroactively, and reprocessing — a manual exercise that can take hours in a high-volume environment. Build secondary period open as a <strong>system dependency</strong> (a prerequisite that blocks Create Accounting from running if not met) rather than a manual checklist item.</p>
            </div>
          </div>

          <h3>Activate Close Monitor</h3>
          <div class="nav-path">
            <span class="nav-path-label">Path</span>
            <span class="nav-path-item">General Ledger</span>
            <span class="nav-path-sep">›</span>
            <span class="nav-path-item">Period Close</span>
            <span class="nav-path-sep">›</span>
            <span class="nav-path-item">Close Monitor</span>
          </div>
          <p>Configure Close Monitor to display both the primary and secondary ledger simultaneously. Set reconciliation variance thresholds appropriate to each use case — tighter for financial instruments and statutory reporting, wider for pre-consolidation staging where intentional differences are expected.</p>

          <table class="field-table">
            <thead><tr><th>Setting</th><th>Recommended Value</th></tr></thead>
            <tbody>
              <tr><td class="field-name">Ledger group</td><td class="field-note">Include both primary and secondary ledgers in the same Close Monitor view</td></tr>
              <tr><td class="field-name">Variance threshold alert</td><td class="field-note">Set per use case. Statutory: 0.1% of total assets. Pre-consolidation: 0.5%. Tax ledger: 1%.</td></tr>
              <tr><td class="field-name">Period close checklist</td><td class="field-note">Add secondary period close explicitly as a step, with secondary ledger owner assigned</td></tr>
            </tbody>
          </table>

          <div class="checkpoint">
            <div class="checkpoint-title">✓ Step 6 Checkpoint</div>
            <ul>
              <li>Secondary ledger GL period open — status confirmed as Open</li>
              <li>All in-scope subledger periods open for secondary ledger (AP, AR, FA, Cost, Projects as applicable)</li>
              <li>Close Monitor configured with both ledgers visible</li>
              <li>Variance thresholds set and documented</li>
              <li>Period open automation or dependency control in place</li>
            </ul>
          </div>
        </div>
      </div>
      <div class="step-nav">
        <button class="btn btn-outline" onclick="showStep('s5')">← Step 5</button>
        <button class="btn btn-primary" onclick="showStep('s7')">Step 7: Validate →</button>
      </div>
    </div>

    <!-- ══════════ STEP 7: Draft Validate ══════════ -->
    <div class="step-section" id="step-s7">
      <div class="step-card">
        <div class="step-card-header">
          <div class="step-badge badge-p1">07</div>
          <div class="step-header-text">
            <div class="step-title">Phase 1 Validation — Draft Create Accounting Run</div>
            <div class="step-subtitle">The Phase 1 exit gate before any SLA rule authoring begins</div>
          </div>
        </div>
        <div class="step-body">
          <div class="nav-path">
            <span class="nav-path-label">Path</span>
            <span class="nav-path-item">Accounting</span>
            <span class="nav-path-sep">›</span>
            <span class="nav-path-item">Create Accounting</span>
            <span class="nav-path-sep">›</span>
            <span class="nav-path-item">Mode: Draft</span>
          </div>

          <p>Run Create Accounting in Draft mode for a sample of transactions across all in-scope subledgers. At Phase 1, the secondary ledger will produce entries that follow the primary ledger's accounting (since no Phase 2 SLA rules exist yet) — mapped through the CoA Mapping Set. The goal is to confirm the infrastructure works correctly before SLA rule authoring begins.</p>

          <table class="field-table">
            <thead><tr><th>Check</th><th>Expected Result</th><th>If Failed</th></tr></thead>
            <tbody>
              <tr><td class="field-name">Secondary ledger journals created</td><td class="field-note">Draft journals visible in secondary ledger for all processed transactions</td><td class="field-note">If no secondary journals: SLAM not assigned or period not open. Check Steps 5 and 6.</td></tr>
              <tr><td class="field-name">Zero suspense postings</td><td class="field-note">No transactions posted to suspense account in secondary</td><td class="field-note">If suspense exists: CoA mapping gaps. Review mapping set — add missing account combinations.</td></tr>
              <tr><td class="field-name">Account derivation via mapping</td><td class="field-note">Secondary journal accounts follow CoA mapping rules, not primary accounts</td><td class="field-note">If secondary shows primary accounts: mapping set not assigned. Check Step 4.</td></tr>
              <tr><td class="field-name">Create Accounting report — zero errors</td><td class="field-note">Execution report shows success for all subledgers</td><td class="field-note">Review error details in the Create Accounting execution report. Common errors in Step: Common Errors section.</td></tr>
            </tbody>
          </table>

          <div class="callout c-ok">
            <span class="callout-icon">✓</span>
            <div class="callout-content">
              <span class="callout-title">Phase 1 Exit Criteria</span>
              <p>Phase 2 (SLA rule authoring) should not begin until all four checks above pass. A secondary ledger that fails the Phase 1 draft validation has an infrastructure problem — adding SLA rules on top of a broken base will produce unpredictable results that are hard to diagnose. Fix Phase 1 completely before starting Phase 2.</p>
            </div>
          </div>

          <div class="checkpoint">
            <div class="checkpoint-title">✓ Step 7 Checkpoint — Phase 1 Complete</div>
            <ul>
              <li>Draft Create Accounting run completed for all in-scope subledgers</li>
              <li>Secondary ledger journals visible and correctly mapped</li>
              <li>Zero suspense postings</li>
              <li>Zero Create Accounting errors</li>
              <li>Phase 1 sign-off obtained from technical lead and finance lead before Phase 2 begins</li>
            </ul>
          </div>
        </div>
      </div>
      <div class="step-nav">
        <button class="btn btn-outline" onclick="showStep('s6')">← Step 6</button>
        <button class="btn btn-primary" onclick="showStep('s8')">Step 8: Naming Guide →</button>
      </div>
    </div>

    <!-- ══════════ STEP 8: Naming Convention ══════════ -->
    <div class="step-section" id="step-s8">
      <div class="step-card">
        <div class="step-card-header">
          <div class="step-badge badge-p1">08</div>
          <div class="step-header-text">
            <div class="step-title">Naming Convention Guide</div>
            <div class="step-subtitle">Consistent names across all SLA objects reduce troubleshooting time by 30–40% in production</div>
          </div>
        </div>
        <div class="step-body">
          <p>All SLA objects — ledgers, SLAMs, JLRs, ADRs, JERs, mapping sets — should follow a consistent naming convention. These names appear in Create Accounting logs, Close Monitor, and reconciliation reports. Inconsistent names make it impossible to distinguish which rule fired for which ledger during production troubleshooting.</p>

          <div class="naming-grid">
            <div class="naming-item">
              <h4>Secondary Ledger</h4>
              <div class="pattern">[ENTITY]_[STANDARD]_SEC</div>
              <div class="example">e.g. <span>UK_UKGAAP_SEC</span></div>
              <div class="example">e.g. <span>DE_HGBSTAT_SEC</span></div>
              <div class="example">e.g. <span>UK_TAX_SEC</span></div>
            </div>
            <div class="naming-item">
              <h4>Subledger Accounting Method</h4>
              <div class="pattern">[ENTITY]_[STANDARD]_SLAM</div>
              <div class="example">e.g. <span>UK_UKGAAP_SLAM</span></div>
              <div class="example">e.g. <span>CORP_LOCALSTAT_SLAM</span></div>
            </div>
            <div class="naming-item">
              <h4>Journal Line Rule</h4>
              <div class="pattern">[SLAM]_[SUBLEDGER]_[EVENT]_[LINE]</div>
              <div class="example">e.g. <span>STAT_AP_PREPAY_DR</span></div>
              <div class="example">e.g. <span>STAT_FA_DEPR_EXP</span></div>
              <div class="example">e.g. <span>STAT_AR_DEFREV_CR</span></div>
            </div>
            <div class="naming-item">
              <h4>Account Derivation Rule</h4>
              <div class="pattern">[SLAM]_[SUBLEDGER]_[ACCOUNT_TYPE]_ADR</div>
              <div class="example">e.g. <span>STAT_AP_PREPAY_ADR</span></div>
              <div class="example">e.g. <span>STAT_FA_ACCDEPR_ADR</span></div>
            </div>
            <div class="naming-item">
              <h4>Journal Entry Rule</h4>
              <div class="pattern">[SLAM]_[SUBLEDGER]_[EVENTCLASS]_JER</div>
              <div class="example">e.g. <span>STAT_AP_INVOICE_JER</span></div>
              <div class="example">e.g. <span>STAT_FA_DEPR_JER</span></div>
            </div>
            <div class="naming-item">
              <h4>CoA Mapping Set</h4>
              <div class="pattern">[ENTITY]_[FROM]_TO_[TO]_MAP</div>
              <div class="example">e.g. <span>UK_CORP_TO_UKGAAP_MAP</span></div>
              <div class="example">e.g. <span>DE_IFRS_TO_HGB_MAP</span></div>
            </div>
          </div>

          <div class="callout c-gold">
            <span class="callout-icon">💡</span>
            <div class="callout-content">
              <span class="callout-title">Naming Convention as Documentation</span>
              <p>A well-formed name makes the object self-documenting. <code>STAT_FA_DEPR_EXP</code> tells you immediately that this is a statutory secondary ledger rule, for the Fixed Assets subledger, related to depreciation, for the expense line. Anyone troubleshooting a Create Accounting issue at 11pm during period close should be able to identify the relevant rule from its name alone — without opening the configuration.</p>
            </div>
          </div>

          <div class="checkpoint">
            <div class="checkpoint-title">✓ Phase 1 Complete — Ready for Phase 2</div>
            <ul>
              <li>Naming convention agreed and documented</li>
              <li>All Phase 1 objects renamed to follow convention if created before convention was finalised</li>
              <li>Phase 1 sign-off complete (Step 7 checkpoint)</li>
              <li>Phase 2 scope confirmed: which subledgers, which use cases, which accounting differences</li>
            </ul>
          </div>
        </div>
      </div>
      <div class="step-nav">
        <button class="btn btn-outline" onclick="showStep('s7')">← Step 7</button>
        <button class="btn btn-oracle" onclick="showStep('p2intro')">Begin Phase 2: SLA Rules →</button>
      </div>
    </div>

    <!-- ══════════ PHASE 2 INTRO ══════════ -->
    <div class="step-section" id="step-p2intro">
      <div class="page-header">
        <div class="page-eyebrow">Phase 2</div>
        <h1 class="page-title">SLA Rule Framework</h1>
        <p class="page-sub">Journal Line Rules, Account Derivation Rules, Journal Entry Rules — assembled into the secondary SLAM per subledger application.</p>
      </div>

      <div class="callout c-info">
        <span class="callout-icon">ℹ</span>
        <div class="callout-content">
          <span class="callout-title">The Four-Object Pattern</span>
          <p>Every accounting difference in the secondary ledger is implemented through the same four-object pattern, regardless of subledger. <strong>A → B → C → D:</strong><br><br>
          <strong>A. Account Derivation Rule (ADR)</strong> — derives the account. Takes a source (Mapping Set, constant, or attribute) and returns a segment value.<br>
          <strong>B. Journal Line Rule (JLR)</strong> — defines one line in a journal entry. Specifies debit or credit, references an ADR, and carries conditions that determine when it fires.<br>
          <strong>C. Journal Entry Rule (JER)</strong> — assembles JLRs into a complete balanced journal entry for a specific Event Class and Event Type.<br>
          <strong>D. SLAM assignment</strong> — the JER is added to the secondary SLAM, scoped to the subledger application, event class, and event type.</p>
        </div>
      </div>

      <div class="callout c-gold">
        <span class="callout-icon">💡</span>
        <div class="callout-content">
          <span class="callout-title">The Condition That Does Most of the Work</span>
          <p>The most important condition in any secondary ledger JLR is <code>Ledger = [Secondary Ledger Name]</code>. This condition ensures the rule fires only when Create Accounting is processing for the secondary ledger — not the primary. Without this condition, the rule fires for both ledgers and corrupts primary ledger accounting. <strong>Every JLR created for the secondary ledger must have this condition.</strong> Priority must be set higher than default rules so the secondary-specific rule takes precedence.</p>
        </div>
      </div>

      <p>Use the subledger tabs below to navigate to the SLA configuration steps for each application. Use the filter chips in the sidebar to hide subledgers not in scope for your implementation.</p>

      <div class="step-nav">
        <button class="btn btn-outline" onclick="showStep('s8')">← Phase 1</button>
        <button class="btn btn-primary" onclick="showStep('sla-gl')">First subledger: GL →</button>
      </div>
    </div>

    <!-- ══════════ SLA: GL ══════════ -->
    <div class="step-section" id="step-sla-gl">
      <div class="step-card">
        <div class="step-card-header">
          <div class="step-badge badge-p2">GL</div>
          <div class="step-header-text">
            <div class="step-title">General Ledger — SLA Configuration</div>
            <div class="step-subtitle">Manual journals, allocations, and adjustment-only secondary ledger entries</div>
          </div>
        </div>
        <div class="step-body">
          <p>For GL-sourced entries (manual journals, allocations, revaluations), the secondary ledger inherits entries automatically at the conversion level configured in Step 2. At <strong>Subledger</strong> level, GL manual journal entries are replicated to the secondary ledger and mapped through the CoA mapping set. No additional SLA rules are required for standard manual journal replication.</p>

          <div class="sla-block">
            <div class="sla-block-header"><span class="sla-letter">A</span><span class="sla-block-title">Scenario: Adjustment-Only Secondary Ledger (Pre-Consolidation)</span></div>
            <div class="sla-block-body">
              <p>If conversion level = <strong>Adjustment Only</strong> (Use Case 12 — Pre-Consolidation), all entries are manual journals entered directly into the secondary ledger. No SLA rules are required. Configure:</p>
              <ul>
                <li><strong>Journal Source:</strong> Create a dedicated journal source (e.g., <code>PRECONS_ADJ</code>) for pre-consolidation entries to distinguish them from operational journals</li>
                <li><strong>Journal Category:</strong> Create categories for each adjustment type (e.g., <code>GOODWILL_AMORT</code>, <code>PPA_STEPUP</code>, <code>IC_PROFIT_ELIM</code>)</li>
                <li><strong>Auto-Reversal:</strong> Configure auto-reversal for period-specific entries that should not carry forward</li>
                <li><strong>Journal Approval:</strong> Set up approval workflow requiring Group Finance sign-off before posting to the adjustment ledger</li>
              </ul>
            </div>
          </div>

          <div class="sla-block">
            <div class="sla-block-header"><span class="sla-letter">B</span><span class="sla-block-title">Scenario: IAS 29 Restatement Entries (Primary Only)</span></div>
            <div class="sla-block-body">
              <p>For hyperinflationary entities, restatement entries must flow only to the primary ledger. The GL restatement process must be configured to scope to the primary ledger only.</p>
              <div class="condition-row"><span>Ledger</span><span class="condition-op">=</span><span>PRIMARY_LEDGER_NAME</span><span style="color:var(--ink3);font-size:11px;margin-left:8px">— Restatement process scoped to primary only</span></div>
              <p>Validate after each restatement run that secondary ledger balances have not been restated. This is a process control, not an SLA rule.</p>
            </div>
          </div>

          <div class="checkpoint">
            <div class="checkpoint-title">✓ GL Checkpoint</div>
            <ul>
              <li>Manual journal replication confirmed in secondary (for Subledger/Journal conversion level)</li>
              <li>If Adjustment Only: journal sources, categories, and approval workflow configured</li>
              <li>IAS 29 restatement scope confirmed as primary only (if applicable)</li>
            </ul>
          </div>
        </div>
      </div>
      <div class="step-nav">
        <button class="btn btn-outline" onclick="showStep('p2intro')">← Phase 2 Intro</button>
        <button class="btn btn-primary" onclick="showStep('sla-ap')">AP →</button>
      </div>
    </div>

    <!-- ══════════ SLA: AP ══════════ -->
    <div class="step-section" id="step-sla-ap">
      <div class="step-card">
        <div class="step-card-header">
          <div class="step-badge badge-p2">AP</div>
          <div class="step-header-text">
            <div class="step-title">Accounts Payable — SLA Configuration</div>
            <div class="step-subtitle">Prepayments, invoices, WHT, bills payable — different account derivation per ledger</div>
          </div>
        </div>
        <div class="step-body">
          <div class="nav-path">
            <span class="nav-path-label">Path</span>
            <span class="nav-path-item">Manage Subledger Accounting</span>
            <span class="nav-path-sep">›</span>
            <span class="nav-path-item">Payables</span>
            <span class="nav-path-sep">›</span>
            <span class="nav-path-item">Journal Line Rules</span>
          </div>

          <h3>Key Event Classes and Types</h3>
          <div class="sla-event-row"><span class="sla-event-class">Invoices</span><span class="sla-event-type">Standard Invoice, Credit Memo, Debit Memo, Prepayment Invoice</span></div>
          <div class="sla-event-row"><span class="sla-event-class">Payments</span><span class="sla-event-type">Payment, Payment Clearing, Payment Maturity</span></div>
          <div class="sla-event-row"><span class="sla-event-class">Prepayments</span><span class="sla-event-type">Prepayment Applied, Prepayment Unapplied</span></div>

          <div class="sla-block">
            <div class="sla-block-header"><span class="sla-letter">A</span><span class="sla-block-title">ADR: Prepayment Expense Account (Secondary)</span></div>
            <div class="sla-block-body">
              <p>Create an ADR that derives the local statutory prepayment expense account when the secondary ledger is being processed.</p>
              <div class="condition-row"><span>Account Source</span><span class="condition-op">:</span><span>Mapping Set</span><span style="color:var(--ink3);font-size:11px;margin-left:8px">Reference the CoA mapping set — maps primary prepayment account to local stat account</span></div>
              <p>Name: <code>STAT_AP_PREPAY_CLRG_ADR</code></p>
            </div>
          </div>

          <div class="sla-block">
            <div class="sla-block-header"><span class="sla-letter">B</span><span class="sla-block-title">JLR: Prepayment Applied — Secondary</span></div>
            <div class="sla-block-body">
              <p>Create a JLR for the Prepayment Applied event that overrides the default account with the local statutory prepayment clearing account.</p>
              <table class="field-table">
                <thead><tr><th>Field</th><th>Value</th></tr></thead>
                <tbody>
                  <tr><td class="field-name">Name</td><td class="field-value">STAT_AP_PREPAY_DR</td></tr>
                  <tr><td class="field-name">Accounting Line Type</td><td class="field-value">Debit</td></tr>
                  <tr><td class="field-name">Account Derivation Rule</td><td class="field-value">STAT_AP_PREPAY_CLRG_ADR</td></tr>
                  <tr><td class="field-name">Condition — Ledger</td><td class="field-value">= UK_UKGAAP_SEC</td></tr>
                  <tr><td class="field-name">Priority</td><td class="field-value">Higher than default rule (e.g. 10 vs default 50)</td></tr>
                </tbody>
              </table>
              <div class="callout c-trap" style="margin-top:10px">
                <span class="callout-icon">⚠</span>
                <div class="callout-content">
                  <span class="callout-title">Priority Must Be Higher Than Default</span>
                  <p>If the secondary JLR has lower priority than the default AP rule, the default rule fires for both ledgers and the secondary-specific rule is ignored. Set secondary rules to priority 10; default rules are typically 50.</p>
                </div>
              </div>
            </div>
          </div>

          <div class="sla-block">
            <div class="sla-block-header"><span class="sla-letter">C</span><span class="sla-block-title">JLR: Withholding Tax — Secondary Account</span></div>
            <div class="sla-block-body">
              <p>If local GAAP requires WHT to be booked to a different liability account in the secondary ledger:</p>
              <div class="condition-row"><span>Ledger</span><span class="condition-op">=</span><span>UK_UKGAAP_SEC</span></div>
              <div class="condition-row"><span>AND Supplier Type</span><span class="condition-op">=</span><span>WITHHOLDING_ELIGIBLE</span></div>
              <p style="margin-top:8px">ADR: derive local stat WHT payable account (e.g., 4100 local CoA vs 2100 primary CoA).</p>
            </div>
          </div>

          <div class="sla-block">
            <div class="sla-block-header"><span class="sla-letter">D</span><span class="sla-block-title">JER Assembly and SLAM Assignment</span></div>
            <div class="sla-block-body">
              <p>Create JERs for each Event Class (Invoices, Payments, Prepayments) that reference the JLRs above. Add each JER to the secondary SLAM under the Payables application.</p>
              <div class="nav-path" style="margin-top:8px">
                <span class="nav-path-label">Path</span>
                <span class="nav-path-item">Manage SLA Methods</span>
                <span class="nav-path-sep">›</span>
                <span class="nav-path-item">[Secondary SLAM]</span>
                <span class="nav-path-sep">›</span>
                <span class="nav-path-item">Payables</span>
                <span class="nav-path-sep">›</span>
                <span class="nav-path-item">Add JER</span>
              </div>
            </div>
          </div>

          <div class="checkpoint">
            <div class="checkpoint-title">✓ AP Checkpoint</div>
            <ul>
              <li>ADRs created for all AP account differences (prepayment, WHT, bills payable)</li>
              <li>JLRs created with Ledger condition and higher priority than defaults</li>
              <li>JERs assembled and added to secondary SLAM under Payables application</li>
              <li>Draft Create Accounting run — AP invoices show correct secondary accounts</li>
              <li>Reconciliation between primary and secondary AP balances — differences explainable</li>
            </ul>
          </div>
        </div>
      </div>
      <div class="step-nav">
        <button class="btn btn-outline" onclick="showStep('sla-gl')">← GL</button>
        <button class="btn btn-primary" onclick="showStep('sla-ar')">AR →</button>
      </div>
    </div>

    <!-- ══════════ SLA: AR ══════════ -->
    <div class="step-section" id="step-sla-ar">
      <div class="step-card">
        <div class="step-card-header">
          <div class="step-badge badge-p2">AR</div>
          <div class="step-header-text">
            <div class="step-title">Accounts Receivable — SLA Configuration</div>
            <div class="step-subtitle">Deferred revenue, revenue recognition timing, receipt application — secondary ledger differences</div>
          </div>
        </div>
        <div class="step-body">
          <h3>Key Event Classes and Types</h3>
          <div class="sla-event-row"><span class="sla-event-class">Revenue</span><span class="sla-event-type">Invoice, Credit Memo, Adjustment</span></div>
          <div class="sla-event-row"><span class="sla-event-class">Receipts</span><span class="sla-event-type">Receipt Application, Receipt Reversal</span></div>
          <div class="sla-event-row"><span class="sla-event-class">Deferred Revenue</span><span class="sla-event-type">Revenue Recognition, Revenue Reversal</span></div>

          <div class="sla-block">
            <div class="sla-block-header"><span class="sla-letter">A</span><span class="sla-block-title">ADR: Deferred Revenue Account (Secondary)</span></div>
            <div class="sla-block-body">
              <p>When an AR invoice is raised for a subscription or milestone contract, the secondary ledger must recognise deferred revenue (local GAAP delivery criterion) instead of immediate revenue (IFRS 15 performance obligation).</p>
              <div class="condition-row"><span>Ledger</span><span class="condition-op">=</span><span>SECONDARY_LEDGER</span></div>
              <div class="condition-row"><span>AND Transaction Type</span><span class="condition-op">=</span><span>SUBSCRIPTION OR DFF_DEFER = Y</span></div>
              <p style="margin-top:8px">ADR derives: Deferred Revenue account 2500 (local CoA) instead of Revenue 4000 (primary CoA).</p>
            </div>
          </div>

          <div class="sla-block">
            <div class="sla-block-header"><span class="sla-letter">B</span><span class="sla-block-title">JLR: Revenue Release on Delivery (Secondary Only)</span></div>
            <div class="sla-block-body">
              <p>The secondary ledger requires an additional journal when delivery is confirmed — to release deferred revenue to recognised revenue. This event does not occur in the primary (revenue was already recognised on invoice under IFRS 15).</p>
              <div class="condition-row"><span>Event Type</span><span class="condition-op">=</span><span>Revenue_Recognition</span></div>
              <div class="condition-row"><span>AND Ledger</span><span class="condition-op">=</span><span>SECONDARY_LEDGER</span></div>
              <div class="condition-row"><span>AND DFF_DELIVERY_CONFIRMED</span><span class="condition-op">=</span><span>Y</span></div>
              <p style="margin-top:8px">DR: Deferred Revenue 2500 / CR: Revenue 5000 (local CoA).</p>
            </div>
          </div>

          <div class="callout c-warn">
            <span class="callout-icon">⚡</span>
            <div class="callout-content">
              <span class="callout-title">DFF Values as Conditions</span>
              <p>Fusion SLA allows Descriptive Flexfield (DFF) values on AR transactions to be used as JLR conditions. This is particularly useful for deferred revenue scenarios where the deferral rule depends on contract terms that are not captured in standard AR transaction type attributes. Populate DFFs at invoice creation and reference them in JLR conditions. Test with a representative sample of transaction types before go-live.</p>
            </div>
          </div>

          <div class="checkpoint">
            <div class="checkpoint-title">✓ AR Checkpoint</div>
            <ul>
              <li>ADRs for deferred revenue, unbilled AR, and revenue accounts in secondary</li>
              <li>JLRs for invoice, revenue recognition, and receipt events with Ledger condition</li>
              <li>DFF-based conditions tested with sample transactions</li>
              <li>Secondary AR balance reconciliation — deferred vs recognised split confirmed</li>
            </ul>
          </div>
        </div>
      </div>
      <div class="step-nav">
        <button class="btn btn-outline" onclick="showStep('sla-ap')">← AP</button>
        <button class="btn btn-primary" onclick="showStep('sla-fa')">Fixed Assets →</button>
      </div>
    </div>

    <!-- ══════════ SLA: FA ══════════ -->
    <div class="step-section" id="step-sla-fa">
      <div class="step-card">
        <div class="step-card-header">
          <div class="step-badge badge-p2">FA</div>
          <div class="step-header-text">
            <div class="step-title">Fixed Assets — SLA Configuration</div>
            <div class="step-subtitle">Component accounting (IAS 16), dual depreciation rules, disposal accounting</div>
          </div>
        </div>
        <div class="step-body">
          <div class="callout c-info">
            <span class="callout-icon">ℹ</span>
            <div class="callout-content">
              <span class="callout-title">FA Has Its Own Asset Book Structure</span>
              <p>Before SLA rules for FA can be configured, a separate <strong>Statutory Asset Book</strong> must exist and be assigned to the secondary ledger. The corporate asset book drives primary ledger entries; the statutory book drives secondary ledger entries. Both asset books share the same physical assets but have independent depreciation methods, rates, and useful lives.</p>
            </div>
          </div>

          <h3>Prerequisite: Statutory Asset Book</h3>
          <div class="nav-path">
            <span class="nav-path-label">Path</span>
            <span class="nav-path-item">Fixed Assets</span>
            <span class="nav-path-sep">›</span>
            <span class="nav-path-item">Setup</span>
            <span class="nav-path-sep">›</span>
            <span class="nav-path-item">Asset Books</span>
            <span class="nav-path-sep">›</span>
            <span class="nav-path-item">Create</span>
          </div>
          <table class="field-table">
            <thead><tr><th>Field</th><th>Value</th></tr></thead>
            <tbody>
              <tr><td class="field-name">Book Type</td><td class="field-value">Tax / Stat</td></tr>
              <tr><td class="field-name">Ledger Assignment</td><td class="field-value">Secondary ledger</td></tr>
              <tr><td class="field-name">Depreciation Method</td><td class="field-value">Local statutory method (e.g., Declining Balance, statutory rates)</td></tr>
              <tr><td class="field-name">Component Tracking</td><td class="field-value">Disabled (statutory book uses pooled asset, no component split)</td></tr>
            </tbody>
          </table>

          <h3>Key Event Classes</h3>
          <div class="sla-event-row"><span class="sla-event-class">Depreciation</span><span class="sla-event-type">Calculate Depreciation, Adjust Depreciation</span></div>
          <div class="sla-event-row"><span class="sla-event-class">Asset Transactions</span><span class="sla-event-type">Addition, Adjustment, Retirement, Transfer</span></div>
          <div class="sla-event-row"><span class="sla-event-class">Revaluation</span><span class="sla-event-type">Revalue Assets (primary only for IAS 16 revaluation model)</span></div>

          <div class="sla-block">
            <div class="sla-block-header"><span class="sla-letter">A</span><span class="sla-block-title">JLR: Depreciation Expense — Statutory (Pooled)</span></div>
            <div class="sla-block-body">
              <p>The statutory asset book uses a single pooled depreciation expense account. The primary corporate book splits depreciation by component type. The JLR for the secondary ledger must derive the pooled account regardless of asset category or component.</p>
              <div class="condition-row"><span>Ledger</span><span class="condition-op">=</span><span>SECONDARY_LEDGER</span></div>
              <div class="condition-row"><span>AND Asset Book</span><span class="condition-op">=</span><span>STAT_BOOK</span></div>
              <p style="margin-top:8px">ADR: static account derivation → Statutory Depreciation Expense 6100 (local CoA). Does not reference component type attribute.</p>
            </div>
          </div>

          <div class="sla-block">
            <div class="sla-block-header"><span class="sla-letter">B</span><span class="sla-block-title">JLR: Asset Disposal — Statutory (Single NBV)</span></div>
            <div class="sla-block-body">
              <p>On disposal, the primary ledger calculates gain/loss net of component-level accumulated depreciation. The secondary ledger calculates based on single pooled NBV. Different account and different amount.</p>
              <div class="condition-row"><span>Event Type</span><span class="condition-op">=</span><span>Full_Retirement</span></div>
              <div class="condition-row"><span>AND Ledger</span><span class="condition-op">=</span><span>SECONDARY_LEDGER</span></div>
              <p style="margin-top:8px">ADR: derive statutory gain/loss account 7200 (local CoA). Amount: statutory book NBV (cost less accumulated statutory depreciation).</p>
            </div>
          </div>

          <div class="callout c-gold">
            <span class="callout-icon">💡</span>
            <div class="callout-content">
              <span class="callout-title">Component Accounting — Primary Only</span>
              <p>Component accounting (IAS 16) is configured on the <strong>corporate asset book</strong>, not on SLA rules. Enable Component Tracking on the corporate book and define component types (Structure, Roof, Mechanical). The statutory book has Component Tracking disabled. Create Accounting automatically produces component-level entries for the primary and pooled entries for the secondary based on the asset book assignments — the SLA rules only override account derivation.</p>
            </div>
          </div>

          <div class="checkpoint">
            <div class="checkpoint-title">✓ FA Checkpoint</div>
            <ul>
              <li>Statutory asset book created and assigned to secondary ledger</li>
              <li>Component tracking enabled on corporate book, disabled on statutory book</li>
              <li>JLRs for depreciation and disposal with Asset Book condition</li>
              <li>Draft Create Accounting — primary shows component entries, secondary shows pooled</li>
              <li>Depreciation amounts differ between books — confirmed by policy, not error</li>
            </ul>
          </div>
        </div>
      </div>
      <div class="step-nav">
        <button class="btn btn-outline" onclick="showStep('sla-ar')">← AR</button>
        <button class="btn btn-primary" onclick="showStep('sla-cost')">Cost Accounting →</button>
      </div>
    </div>

    <!-- ══════════ SLA: COST ══════════ -->
    <div class="step-section" id="step-sla-cost">
      <div class="step-card">
        <div class="step-card-header">
          <div class="step-badge badge-p2">CA</div>
          <div class="step-header-text">
            <div class="step-title">Cost Accounting — SLA Configuration</div>
            <div class="step-subtitle">Dual cost books, standard vs actual, independent inventory account derivation</div>
          </div>
        </div>
        <div class="step-body">
          <div class="callout c-info">
            <span class="callout-icon">ℹ</span>
            <div class="callout-content">
              <span class="callout-title">Cost Books Must Be Configured First</span>
              <p>Like FA, Cost Accounting has its own book structure. A separate <strong>Statutory Cost Book</strong> must be created and assigned to the secondary ledger before SLA rules are configured. The corporate cost book (Standard Cost) drives primary ledger entries; the statutory cost book (Actual/WAC) drives secondary entries.</p>
            </div>
          </div>

          <h3>Prerequisite: Statutory Cost Book</h3>
          <div class="nav-path">
            <span class="nav-path-label">Path</span>
            <span class="nav-path-item">Supply Chain</span>
            <span class="nav-path-sep">›</span>
            <span class="nav-path-item">Cost Accounting</span>
            <span class="nav-path-sep">›</span>
            <span class="nav-path-item">Manage Cost Books</span>
            <span class="nav-path-sep">›</span>
            <span class="nav-path-item">Create</span>
          </div>
          <table class="field-table">
            <thead><tr><th>Field</th><th>Corporate Book</th><th>Statutory Book</th></tr></thead>
            <tbody>
              <tr><td class="field-name">Cost Method</td><td class="field-value">Standard</td><td class="field-value">Actual / WAC / FIFO</td></tr>
              <tr><td class="field-name">Ledger</td><td class="field-value">Primary</td><td class="field-value">Secondary</td></tr>
              <tr><td class="field-name">Valuation Structure</td><td class="field-value">Standard Cost Profile</td><td class="field-value">Actual Cost Profile</td></tr>
            </tbody>
          </table>

          <h3>Key Event Classes</h3>
          <div class="sla-event-row"><span class="sla-event-class">Inventory Transactions</span><span class="sla-event-type">PO Receipt, WIP Completion, Issue, Transfer</span></div>
          <div class="sla-event-row"><span class="sla-event-class">Cost Variances</span><span class="sla-event-type">Purchase Price Variance, WIP Variance — primary only</span></div>
          <div class="sla-event-row"><span class="sla-event-class">WIP Transactions</span><span class="sla-event-type">WIP Issue, WIP Completion, Scrap</span></div>

          <div class="sla-block">
            <div class="sla-block-header"><span class="sla-letter">A</span><span class="sla-block-title">JLR: Inventory Valuation — Actual Cost (Secondary)</span></div>
            <div class="sla-block-body">
              <div class="condition-row"><span>Ledger</span><span class="condition-op">=</span><span>SECONDARY_LEDGER</span></div>
              <div class="condition-row"><span>AND Cost Book</span><span class="condition-op">=</span><span>STAT_COST_BOOK</span></div>
              <p style="margin-top:8px">ADR: derive statutory inventory account (3100 local CoA) vs primary standard cost inventory account (1310). Amount = actual cost from statutory cost book.</p>
            </div>
          </div>

          <div class="sla-block">
            <div class="sla-block-header"><span class="sla-letter">B</span><span class="sla-block-title">JLR: PPV Suppression (Secondary — No Variance Account)</span></div>
            <div class="sla-block-body">
              <p>Purchase Price Variance only exists in the primary (standard cost book). The secondary actual cost book absorbs the actual cost directly with no variance. Configure the secondary SLAM to suppress PPV lines for the secondary ledger:</p>
              <div class="condition-row"><span>Event Type</span><span class="condition-op">=</span><span>PO_Receipt</span></div>
              <div class="condition-row"><span>AND Ledger</span><span class="condition-op">=</span><span>SECONDARY_LEDGER</span></div>
              <p style="margin-top:8px">Result: no PPV debit/credit line in secondary journal. Receiving clearing and AP liability balance at actual invoice cost.</p>
            </div>
          </div>

          <div class="checkpoint">
            <div class="checkpoint-title">✓ Cost Accounting Checkpoint</div>
            <ul>
              <li>Statutory cost book created and assigned to secondary ledger</li>
              <li>Standard cost updates only applied to corporate book</li>
              <li>JLRs for inventory, WIP, and receipt with Cost Book condition</li>
              <li>PPV suppression confirmed in secondary ledger draft run</li>
              <li>Inventory balance reconciliation: secondary (actual) vs primary (standard) — variance = PPV + cost method difference</li>
            </ul>
          </div>
        </div>
      </div>
      <div class="step-nav">
        <button class="btn btn-outline" onclick="showStep('sla-fa')">← Fixed Assets</button>
        <button class="btn btn-primary" onclick="showStep('sla-proj')">Projects →</button>
      </div>
    </div>

    <!-- ══════════ SLA: PROJECTS ══════════ -->
    <div class="step-section" id="step-sla-proj">
      <div class="step-card">
        <div class="step-card-header">
          <div class="step-badge badge-p2">PJ</div>
          <div class="step-header-text">
            <div class="step-title">Projects — SLA Configuration</div>
            <div class="step-subtitle">IFRS 15 vs local GAAP revenue, cost capitalisation vs expense, unbilled receivables</div>
          </div>
        </div>
        <div class="step-body">
          <div class="callout c-warn">
            <span class="callout-icon">⚡</span>
            <div class="callout-content">
              <span class="callout-title">Validate Unbilled Receivables Flow in First Three Periods</span>
              <p>Project-to-secondary-ledger integration for unbilled receivables and deferred revenue can have gaps when IFRS 15 performance obligations and local GAAP recognition differ significantly. The SLA rules below address the main scenarios, but schedule a manual reconciliation review for the first three periods after go-live.</p>
            </div>
          </div>

          <h3>Key Event Classes</h3>
          <div class="sla-event-row"><span class="sla-event-class">Revenue</span><span class="sla-event-type">Revenue Recognition, Revenue Reversal</span></div>
          <div class="sla-event-row"><span class="sla-event-class">Expenditure</span><span class="sla-event-type">Cost Distribution — capitalisation vs expense</span></div>
          <div class="sla-event-row"><span class="sla-event-class">Billing</span><span class="sla-event-type">Unbilled Receivable, Bill to Receivable</span></div>

          <div class="sla-block">
            <div class="sla-block-header"><span class="sla-letter">A</span><span class="sla-block-title">JLR: Revenue Recognition — PoC Method (Secondary)</span></div>
            <div class="sla-block-body">
              <p>Primary uses IFRS 15 performance obligation allocation. Secondary uses Percentage-of-Completion (cost-to-cost).</p>
              <div class="condition-row"><span>Ledger</span><span class="condition-op">=</span><span>SECONDARY_LEDGER</span></div>
              <div class="condition-row"><span>AND Project Type</span><span class="condition-op">=</span><span>FIXED_PRICE</span></div>
              <div class="condition-row"><span>AND Revenue Method</span><span class="condition-op">=</span><span>LOCAL_GAAP_POC</span></div>
              <p style="margin-top:8px">ADR: derive local stat revenue account 5000. Amount: PoC % × contract value (differs from primary performance obligation allocation).</p>
            </div>
          </div>

          <div class="sla-block">
            <div class="sla-block-header"><span class="sla-letter">B</span><span class="sla-block-title">JLR: Development Cost — Expense vs Capitalise</span></div>
            <div class="sla-block-body">
              <p>Primary capitalises development costs under IAS 38. Secondary expenses them under local GAAP.</p>
              <div class="condition-row"><span>Ledger</span><span class="condition-op">=</span><span>SECONDARY_LEDGER</span></div>
              <div class="condition-row"><span>AND Expenditure Type</span><span class="condition-op">=</span><span>DEVELOPMENT</span></div>
              <p style="margin-top:8px">Primary JLR: DR Intangible Asset 1700. Secondary JLR: DR Development Expense 7500. Same event, different accounting line.</p>
            </div>
          </div>

          <div class="sla-block">
            <div class="sla-block-header"><span class="sla-letter">C</span><span class="sla-block-title">JLR: Unbilled Receivable — Secondary Account</span></div>
            <div class="sla-block-body">
              <div class="condition-row"><span>Event Type</span><span class="condition-op">=</span><span>Unbilled_Receivable</span></div>
              <div class="condition-row"><span>AND Ledger</span><span class="condition-op">=</span><span>SECONDARY_LEDGER</span></div>
              <p style="margin-top:8px">ADR: derive local statutory unbilled AR account 3300 vs primary 1250. Same amount but different account in secondary CoA.</p>
            </div>
          </div>

          <div class="checkpoint">
            <div class="checkpoint-title">✓ Projects Checkpoint</div>
            <ul>
              <li>JLRs for revenue recognition with Project Type and Revenue Method conditions</li>
              <li>JLRs for development cost capitalisation vs expense with Expenditure Type condition</li>
              <li>Unbilled receivable account derivation confirmed in secondary</li>
              <li>Manual reconciliation scheduled for first three periods post-go-live</li>
              <li>Revenue recognition amount difference between books documented and explainable by method</li>
            </ul>
          </div>
        </div>
      </div>
      <div class="step-nav">
        <button class="btn btn-outline" onclick="showStep('sla-cost')">← Cost Accounting</button>
        <button class="btn btn-primary" onclick="showStep('errors')">Common Errors →</button>
      </div>
    </div>

    <!-- ══════════ COMMON ERRORS ══════════ -->
    <div class="step-section" id="step-errors">
      <div class="step-card">
        <div class="step-card-header">
          <div class="step-badge" style="background:#FFF0EC;color:var(--oracle);border:1px solid var(--oracle-border)">!</div>
          <div class="step-header-text">
            <div class="step-title">Common Errors — Cause and Resolution</div>
            <div class="step-subtitle">The errors that appear in 80% of secondary ledger implementations</div>
          </div>
        </div>
        <div class="step-body">
          <table class="error-table">
            <thead><tr><th>Error / Symptom</th><th>Root Cause</th><th>Resolution</th></tr></thead>
            <tbody>
              <tr>
                <td><span class="err-sym">Secondary journals identical to primary</span></td>
                <td>Secondary SLAM is the same as primary SLAM, or SLAM not assigned</td>
                <td><span class="err-res">Assign a dedicated secondary SLAM (Step 5). Confirm SLAM name in ledger options.</span></td>
              </tr>
              <tr>
                <td><span class="err-sym">Transactions post to suspense in secondary</span></td>
                <td>CoA mapping set has gaps — account combinations not covered by any rule</td>
                <td><span class="err-res">Review mapping set. Add rollup or account rules for unmapped combinations. Re-run Create Accounting in Draft.</span></td>
              </tr>
              <tr>
                <td><span class="err-sym">No secondary journals created at all</span></td>
                <td>Secondary period not open when Create Accounting ran</td>
                <td><span class="err-res">Open secondary period (Step 6). Reprocess unaccounted transactions for the secondary ledger.</span></td>
              </tr>
              <tr>
                <td><span class="err-sym">JLR condition fires for primary AND secondary</span></td>
                <td>Ledger condition missing from JLR, or priority lower than default rule</td>
                <td><span class="err-res">Add Ledger = SECONDARY_LEDGER condition to every secondary JLR. Set priority higher than default (e.g., 10 vs 50).</span></td>
              </tr>
              <tr>
                <td><span class="err-sym">Secondary accounts use primary CoA codes</span></td>
                <td>Mapping set not assigned to secondary ledger (Step 4 skipped)</td>
                <td><span class="err-res">Assign mapping set in Manage Accounting Configurations › Secondary Ledger › Mapping. Verify assignment persisted.</span></td>
              </tr>
              <tr>
                <td><span class="err-sym">FA: same depreciation amounts in both books</span></td>
                <td>Statutory asset book not created or not assigned to secondary ledger</td>
                <td><span class="err-res">Create statutory asset book with correct depreciation method. Assign to secondary ledger in Asset Book setup.</span></td>
              </tr>
              <tr>
                <td><span class="err-sym">Cost: PPV appearing in secondary ledger</span></td>
                <td>PPV suppression JLR not configured for secondary ledger</td>
                <td><span class="err-res">Create JLR with Cost Book = STAT_COST_BOOK condition that suppresses PPV line. Add to secondary SLAM under Cost Management application.</span></td>
              </tr>
              <tr>
                <td><span class="err-sym">Post-go-live: secondary has no historical data</span></td>
                <td>Secondary ledger activated mid-year; no historical balance migration performed</td>
                <td><span class="err-res">Create opening balance journal in secondary ledger as of activation date. Source balances from primary ledger mapped through CoA mapping set. Get sign-off before posting.</span></td>
              </tr>
              <tr>
                <td><span class="err-sym">IAS 29: secondary ledger balances restated</span></td>
                <td>Restatement process run against both ledgers instead of primary only</td>
                <td><span class="err-res">Reverse restatement entries in secondary. Re-run restatement with explicit primary-only scope. Add scope validation to period-end checklist.</span></td>
              </tr>
              <tr>
                <td><span class="err-sym">Projects: unbilled receivables missing in secondary</span></td>
                <td>Project event type for unbilled AR not covered by secondary JLR</td>
                <td><span class="err-res">Create JLR for Billing event class / Unbilled_Receivable event type with Ledger condition. Add ADR for secondary unbilled AR account.</span></td>
              </tr>
            </tbody>
          </table>

          <div class="callout c-ok">
            <span class="callout-icon">✓</span>
            <div class="callout-content">
              <span class="callout-title">Configuration Complete</span>
              <p>With Phase 1 and Phase 2 complete across all in-scope subledgers, run a final Create Accounting in Final mode for a full period. Reconcile primary and secondary ledger balances using the Close Monitor and the Secondary Ledger Reconciliation Report (<strong>General Ledger › Period Close › Reconciliation</strong>). All inter-ledger differences should be explainable by policy — document each difference type before sign-off.</p>
            </div>
          </div>
        </div>
      </div>
      <div class="step-nav">
        <button class="btn btn-outline" onclick="showStep('sla-proj')">← Projects</button>
        <button class="btn btn-complete" onclick="showStep('intro')">↺ Back to Overview</button>
      </div>
    </div>

  </div><!-- end content -->
</main>
</div><!-- end shell -->

<script>
// ── STATE ──
const STEPS_ORDER = ['intro','s1','s2','s3','s4','s5','s6','s7','s8','p2intro','sla-gl','sla-ap','sla-ar','sla-fa','sla-cost','sla-proj','errors'];
let currentStep = 'intro';
let completedSteps = new Set();

function showStep(id) {
  document.querySelectorAll('.step-section').forEach(s => s.classList.remove('visible'));
  const el = document.getElementById('step-' + id);
  if (el) el.classList.add('visible');

  document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
  const navEl = document.getElementById('nav-' + id);
  if (navEl) navEl.classList.add('active');

  completedSteps.add(currentStep);
  currentStep = id;

  updateProgress();
  window.scrollTo({ top: 0, behavior: 'smooth' });
}

function updateProgress() {
  const total = STEPS_ORDER.length - 1;
  const done = completedSteps.size;
  const pct = Math.min(100, Math.round((done / total) * 100));
  document.getElementById('progressFill').style.width = pct + '%';
  document.getElementById('progressCount').textContent = done + ' / ' + total;

  completedSteps.forEach(id => {
    const navEl = document.getElementById('nav-' + id);
    if (navEl) navEl.classList.add('complete');
  });
}

// ── SUBLEDGER FILTER ──
const activeFilters = new Set(['gl','ap','ar','fa','cost','proj']);

function toggleFilter(chip) {
  const filter = chip.dataset.filter;
  if (activeFilters.has(filter)) {
    if (activeFilters.size === 1) return; // keep at least one
    activeFilters.delete(filter);
    chip.classList.remove('active');
  } else {
    activeFilters.add(filter);
    chip.classList.add('active');
  }
  applyFilters();
}

function applyFilters() {
  const subledgerMap = { gl: 'sla-gl', ap: 'sla-ap', ar: 'sla-ar', fa: 'sla-fa', cost: 'sla-cost', proj: 'sla-proj' };
  Object.entries(subledgerMap).forEach(([key, navId]) => {
    const navEl = document.getElementById('nav-' + navId);
    if (navEl) {
      navEl.style.opacity = activeFilters.has(key) ? '1' : '0.3';
      navEl.style.pointerEvents = activeFilters.has(key) ? 'auto' : 'none';
    }
  });
}
</script>
</body>
</html>
