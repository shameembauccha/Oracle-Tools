<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Oracle Fusion Balancing Segments ‚Äî Industry Explorer</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;900&family=IBM+Plex+Mono:wght@400;500&family=IBM+Plex+Sans:wght@300;400;500&display=swap" rel="stylesheet">
<style>
  :root {
    --ink: #0a0a0f;
    --paper: #f5f2eb;
    --accent: #c8410a;
    --accent2: #1a4a7a;
    --muted: #7a7570;
    --border: #d4cfc5;
    --highlight: #fff8e7;
    --secondary-tag: #d4e8f0;
    --tertiary-tag: #f0e4d4;
    --row-hover: #fdf9f0;
    --seg-mandatory: #1a3a5c;
    --seg-essential: #1e6b45;
    --seg-common: #7a4010;
    --seg-frequent: #5a2d82;
    --seg-optional: #8a6a00;
  }

  * { box-sizing: border-box; margin: 0; padding: 0; }

  body {
    font-family: 'IBM Plex Sans', sans-serif;
    background: var(--paper);
    color: var(--ink);
    font-size: 14px;
    line-height: 1.6;
  }

  .wrapper {
    max-width: 1600px;
    margin: 0 auto;
    padding: 48px 24px 80px;
  }

  .header {
    margin-bottom: 40px;
    border-bottom: 3px solid var(--ink);
    padding-bottom: 32px;
  }

  .header-eyebrow {
    font-family: 'IBM Plex Mono', monospace;
    font-size: 11px;
    letter-spacing: 0.15em;
    text-transform: uppercase;
    color: var(--accent);
    margin-bottom: 12px;
  }

  .header h1 {
    font-family: 'Playfair Display', serif;
    font-size: clamp(26px, 4vw, 48px);
    font-weight: 900;
    line-height: 1.1;
    color: var(--ink);
    margin-bottom: 16px;
  }

  .header h1 span { color: var(--accent); }

  .header-sub {
    font-size: 15px;
    color: var(--muted);
    max-width: 700px;
    font-weight: 300;
  }

  .legend {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    margin-bottom: 20px;
    padding: 14px 18px;
    background: white;
    border: 1.5px solid var(--border);
    align-items: center;
  }

  .legend-title {
    font-family: 'IBM Plex Mono', monospace;
    font-size: 10px;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    color: var(--muted);
    width: 100%;
    margin-bottom: 2px;
  }

  .legend-item {
    display: flex;
    align-items: center;
    gap: 7px;
    font-size: 11px;
    color: var(--ink);
  }

  .legend-chip {
    display: inline-block;
    width: 24px;
    height: 10px;
    border-radius: 2px;
    flex-shrink: 0;
  }

  .controls {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    margin-bottom: 24px;
    align-items: center;
  }

  .search-wrap {
    position: relative;
    flex: 1;
    min-width: 200px;
    max-width: 300px;
  }

  .search-wrap svg {
    position: absolute;
    left: 11px;
    top: 50%;
    transform: translateY(-50%);
    color: var(--muted);
    pointer-events: none;
  }

  .search-input {
    width: 100%;
    padding: 9px 12px 9px 34px;
    border: 1.5px solid var(--border);
    background: white;
    font-family: 'IBM Plex Sans', sans-serif;
    font-size: 13px;
    color: var(--ink);
    outline: none;
    transition: border-color 0.2s;
  }

  .search-input:focus { border-color: var(--accent); }

  .select-wrap { position: relative; }

  .industry-select {
    appearance: none;
    padding: 9px 30px 9px 13px;
    border: 1.5px solid var(--border);
    background: white;
    font-family: 'IBM Plex Sans', sans-serif;
    font-size: 12px;
    color: var(--ink);
    cursor: pointer;
    outline: none;
    min-width: 210px;
    transition: border-color 0.2s;
  }

  .industry-select:focus { border-color: var(--accent); }

  .select-arrow {
    position: absolute;
    right: 10px;
    top: 50%;
    transform: translateY(-50%);
    pointer-events: none;
    color: var(--muted);
    font-size: 10px;
  }

  .filter-group {
    display: flex;
    flex-wrap: wrap;
    gap: 7px;
    align-items: center;
  }

  .filter-label {
    font-family: 'IBM Plex Mono', monospace;
    font-size: 10px;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    color: var(--muted);
  }

  .filter-btn {
    padding: 6px 13px;
    border: 1.5px solid var(--border);
    background: white;
    font-family: 'IBM Plex Mono', monospace;
    font-size: 10px;
    letter-spacing: 0.05em;
    color: var(--muted);
    cursor: pointer;
    transition: all 0.15s;
    text-transform: uppercase;
  }

  .filter-btn:hover { border-color: var(--ink); color: var(--ink); }
  .filter-btn.active { background: var(--ink); color: var(--paper); border-color: var(--ink); }
  .filter-btn.secondary.active { background: var(--accent2); border-color: var(--accent2); color: white; }
  .filter-btn.tertiary.active { background: var(--accent); border-color: var(--accent); color: white; }

  .results-count {
    font-family: 'IBM Plex Mono', monospace;
    font-size: 11px;
    color: var(--muted);
    margin-left: auto;
  }

  .table-wrap {
    overflow-x: auto;
    border: 1.5px solid var(--border);
    background: white;
  }

  table {
    width: 100%;
    border-collapse: collapse;
    min-width: 1300px;
  }

  thead tr { background: var(--ink); color: var(--paper); }

  th {
    font-family: 'IBM Plex Mono', monospace;
    font-size: 10px;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    padding: 13px 14px;
    text-align: left;
    font-weight: 500;
    white-space: nowrap;
    cursor: pointer;
    user-select: none;
  }

  th:hover { background: #1a1a2a; }
  th .sort-icon { display: inline-block; margin-left: 5px; opacity: 0.4; font-size: 9px; }
  th.sorted .sort-icon { opacity: 1; color: var(--accent); }

  tbody tr {
    border-bottom: 1px solid var(--border);
    transition: background 0.15s;
    cursor: pointer;
  }

  tbody tr:hover { background: var(--row-hover); }
  tbody tr.expanded { background: var(--highlight); }

  td {
    padding: 12px 14px;
    vertical-align: top;
    font-size: 12px;
  }

  .td-industry {
    font-family: 'Playfair Display', serif;
    font-weight: 700;
    font-size: 13px;
    color: var(--ink);
    min-width: 150px;
    max-width: 165px;
  }

  .td-who {
    color: var(--accent2);
    font-size: 11px;
    font-weight: 500;
    min-width: 145px;
    max-width: 170px;
  }

  .td-question {
    color: var(--muted);
    font-style: italic;
    font-size: 11px;
    min-width: 175px;
    max-width: 215px;
  }

  .td-segment { min-width: 145px; }

  .seg-badge {
    display: inline-block;
    padding: 2px 8px;
    font-family: 'IBM Plex Mono', monospace;
    font-size: 9px;
    letter-spacing: 0.05em;
    text-transform: uppercase;
    border-radius: 2px;
    font-weight: 500;
    margin-bottom: 3px;
  }

  .seg-secondary { background: var(--secondary-tag); color: var(--accent2); }
  .seg-tertiary { background: var(--tertiary-tag); color: var(--accent); }
  .seg-name { font-weight: 600; font-size: 12px; display: block; margin-top: 1px; }

  .td-kpi { min-width: 175px; }

  .kpi-item {
    display: flex;
    align-items: baseline;
    gap: 5px;
    margin-bottom: 3px;
    font-size: 11px;
  }

  .kpi-icon { font-size: 11px; flex-shrink: 0; }
  .kpi-value { font-family: 'IBM Plex Mono', monospace; font-size: 10px; font-weight: 500; color: var(--accent); }

  .td-coa { min-width: 280px; max-width: 340px; }

  .coa-structure {
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    gap: 3px;
    row-gap: 5px;
  }

  .coa-seg-wrap {
    display: flex;
    align-items: center;
    gap: 3px;
  }

  .coa-seg {
    display: inline-block;
    padding: 3px 7px;
    border-radius: 3px;
    font-family: 'IBM Plex Mono', monospace;
    font-size: 9px;
    font-weight: 500;
    color: white;
    white-space: nowrap;
  }

  .coa-arrow {
    color: #bbb;
    font-size: 11px;
    flex-shrink: 0;
  }

  .freq-mandatory { background: var(--seg-mandatory); }
  .freq-essential  { background: var(--seg-essential); }
  .freq-common     { background: var(--seg-common); }
  .freq-frequent   { background: var(--seg-frequent); }
  .freq-optional   { background: var(--seg-optional); }

  .expand-btn {
    background: none;
    border: none;
    cursor: pointer;
    padding: 0;
    color: var(--muted);
    font-size: 13px;
    transition: transform 0.2s, color 0.2s;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 22px;
    height: 22px;
  }

  .expand-btn:hover { color: var(--ink); }
  tr.expanded .expand-btn { transform: rotate(180deg); color: var(--accent); }

  .detail-row { display: none; }
  .detail-row.visible { display: table-row; }

  .detail-cell {
    padding: 0 !important;
    background: var(--highlight) !important;
  }

  .detail-inner {
    padding: 18px 22px 24px;
    display: grid;
    grid-template-columns: 1fr 1fr 1fr;
    gap: 20px;
    border-top: 2px solid var(--accent);
  }

  .detail-block h4 {
    font-family: 'IBM Plex Mono', monospace;
    font-size: 10px;
    letter-spacing: 0.12em;
    text-transform: uppercase;
    color: var(--accent);
    margin-bottom: 8px;
    padding-bottom: 5px;
    border-bottom: 1px solid var(--border);
  }

  .detail-block p { font-size: 12px; color: var(--ink); line-height: 1.65; }

  .stats-bar {
    display: flex;
    gap: 28px;
    flex-wrap: wrap;
    margin-top: 28px;
    padding: 18px 22px;
    background: var(--ink);
    color: var(--paper);
  }

  .stat-num {
    font-family: 'Playfair Display', serif;
    font-size: 26px;
    font-weight: 900;
    color: var(--accent);
    line-height: 1;
  }

  .stat-label {
    font-family: 'IBM Plex Mono', monospace;
    font-size: 10px;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    color: #999;
    margin-top: 3px;
  }

  .no-results {
    text-align: center;
    padding: 50px 20px;
    color: var(--muted);
    font-style: italic;
    display: none;
  }

  /* REFERENCE PANEL */
  .ref-panel {
    margin-top: 48px;
    border: 1.5px solid var(--border);
    background: white;
  }

  .ref-panel-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 16px 22px;
    background: var(--ink);
    cursor: pointer;
    user-select: none;
  }

  .ref-panel-header-left {
    display: flex;
    align-items: center;
    gap: 14px;
  }

  .ref-panel-eyebrow {
    font-family: 'IBM Plex Mono', monospace;
    font-size: 10px;
    letter-spacing: 0.12em;
    text-transform: uppercase;
    color: var(--accent);
  }

  .ref-panel-title {
    font-family: 'Playfair Display', serif;
    font-size: 18px;
    font-weight: 700;
    color: var(--paper);
  }

  .ref-panel-toggle {
    font-size: 18px;
    color: var(--accent);
    transition: transform 0.25s;
    flex-shrink: 0;
  }

  .ref-panel-toggle.open { transform: rotate(180deg); }

  .ref-panel-body {
    display: none;
    padding: 28px 28px 32px;
  }

  .ref-panel-body.open { display: block; }

  .ref-intro {
    font-size: 13px;
    color: var(--muted);
    max-width: 820px;
    margin-bottom: 28px;
    line-height: 1.7;
    border-left: 3px solid var(--accent);
    padding-left: 16px;
  }

  .ref-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
    margin-bottom: 32px;
  }

  .ref-card {
    border: 1.5px solid var(--border);
    padding: 20px 22px;
  }

  .ref-card-badge {
    display: inline-block;
    font-family: 'IBM Plex Mono', monospace;
    font-size: 9px;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    padding: 3px 10px;
    border-radius: 2px;
    margin-bottom: 12px;
    font-weight: 500;
  }

  .ref-card-badge.interco { background: #e8f0e8; color: #1e6b45; }
  .ref-card-badge.intraco { background: var(--secondary-tag); color: var(--accent2); }

  .ref-card h3 {
    font-family: 'Playfair Display', serif;
    font-size: 16px;
    font-weight: 700;
    color: var(--ink);
    margin-bottom: 10px;
  }

  .ref-card p {
    font-size: 12px;
    color: var(--muted);
    line-height: 1.7;
    margin-bottom: 10px;
  }

  .ref-card p strong { color: var(--ink); font-weight: 600; }

  .ref-card-detail {
    background: var(--paper);
    padding: 10px 14px;
    font-size: 11px;
    color: var(--ink);
    line-height: 1.65;
    border-left: 3px solid var(--border);
    margin-top: 10px;
  }

  .ref-card-detail.interco { border-left-color: #1e6b45; }
  .ref-card-detail.intraco { border-left-color: var(--accent2); }

  /* COMPARISON TABLE */
  .ref-table-title {
    font-family: 'IBM Plex Mono', monospace;
    font-size: 10px;
    letter-spacing: 0.12em;
    text-transform: uppercase;
    color: var(--accent);
    margin-bottom: 12px;
  }

  .ref-compare-table {
    width: 100%;
    border-collapse: collapse;
    font-size: 12px;
    border: 1.5px solid var(--border);
  }

  .ref-compare-table thead tr { background: var(--ink); color: var(--paper); }

  .ref-compare-table th {
    font-family: 'IBM Plex Mono', monospace;
    font-size: 10px;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    padding: 11px 16px;
    text-align: left;
    font-weight: 500;
  }

  .ref-compare-table td {
    padding: 11px 16px;
    border-bottom: 1px solid var(--border);
    vertical-align: top;
    line-height: 1.6;
  }

  .ref-compare-table tbody tr:last-child td { border-bottom: none; }
  .ref-compare-table tbody tr:nth-child(even) { background: var(--paper); }

  .ref-compare-table td:first-child {
    font-family: 'IBM Plex Mono', monospace;
    font-size: 11px;
    font-weight: 500;
    color: var(--muted);
    white-space: nowrap;
    width: 200px;
  }

  .ref-compare-table td.yes {
    color: #1e6b45;
    font-weight: 600;
    font-family: 'IBM Plex Mono', monospace;
    font-size: 11px;
  }

  .ref-compare-table td.no {
    color: var(--accent);
    font-weight: 600;
    font-family: 'IBM Plex Mono', monospace;
    font-size: 11px;
  }

  .ref-warning {
    margin-top: 20px;
    padding: 14px 18px;
    background: #fff4f0;
    border: 1.5px solid #f0c4b4;
    font-size: 12px;
    color: var(--ink);
    line-height: 1.65;
  }

  .ref-warning strong {
    font-family: 'IBM Plex Mono', monospace;
    font-size: 11px;
    letter-spacing: 0.05em;
    text-transform: uppercase;
    color: var(--accent);
    display: block;
    margin-bottom: 6px;
  }

  @media (max-width: 768px) {
    .detail-inner { grid-template-columns: 1fr; }
    .controls { flex-direction: column; align-items: stretch; }
    .results-count { margin-left: 0; }
    .ref-grid { grid-template-columns: 1fr; }
  }
</style>
</head>
<body>
<div class="wrapper">

  <div class="header">
    <div class="header-eyebrow">Oracle Fusion Cloud ERP ¬∑ GL Architecture</div>
    <h1>The Case for <span>Additional Balancing Segments</span><br>by Industry</h1>
    <p class="header-sub">Why one balancing segment was never enough ‚Äî and what Oracle Fusion's secondary and tertiary balancing segments solve across every major vertical. Includes typical CoA structures per industry.</p>
  </div>

  <div class="legend">
    <div class="legend-title">CoA Segment Colour Coding ‚Äî Frequency of Use</div>
    <div class="legend-item"><span class="legend-chip" style="background:var(--seg-mandatory)"></span>Mandatory (always present)</div>
    <div class="legend-item"><span class="legend-chip" style="background:var(--seg-essential)"></span>Essential (near-universal)</div>
    <div class="legend-item"><span class="legend-chip" style="background:var(--seg-common)"></span>Common (most industries)</div>
    <div class="legend-item"><span class="legend-chip" style="background:var(--seg-frequent)"></span>Frequent (specific verticals)</div>
    <div class="legend-item"><span class="legend-chip" style="background:var(--seg-optional)"></span>Optional / Industry-specific</div>
  </div>

  <div class="controls">
    <div class="search-wrap">
      <svg width="13" height="13" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg>
      <input class="search-input" id="searchInput" type="text" placeholder="Search industry, role, segment...">
    </div>

    <div class="select-wrap">
      <select class="industry-select" id="industrySelect">
        <option value="all">All Industries</option>
      </select>
      <span class="select-arrow">‚ñº</span>
    </div>

    <div class="filter-group">
      <span class="filter-label">Segment:</span>
      <button class="filter-btn active" data-filter="all">All</button>
      <button class="filter-btn secondary" data-filter="secondary">Secondary</button>
      <button class="filter-btn tertiary" data-filter="tertiary">Tertiary</button>
    </div>

    <span class="results-count" id="resultsCount"></span>
  </div>

  <div class="table-wrap">
    <table id="mainTable">
      <thead>
        <tr>
          <th data-col="industry">Industry <span class="sort-icon">‚Üï</span></th>
          <th data-col="who">Who to Talk To <span class="sort-icon">‚Üï</span></th>
          <th data-col="question">Question to Ask <span class="sort-icon">‚Üï</span></th>
          <th data-col="segmentName">Segment <span class="sort-icon">‚Üï</span></th>
          <th>Typical CoA Structure</th>
          <th data-col="kpiLabel">Key KPIs Saved <span class="sort-icon">‚Üï</span></th>
          <th style="width:34px;"></th>
        </tr>
      </thead>
      <tbody id="tableBody"></tbody>
    </table>
    <div class="no-results" id="noResults">No results found. Try a different search or filter.</div>
  </div>

  <div class="stats-bar">
    <div><div class="stat-num" id="statIndustries">0</div><div class="stat-label">Industries Covered</div></div>
    <div><div class="stat-num">70‚Äì80%</div><div class="stat-label">Avg. Reduction in Manual Journals</div></div>
    <div><div class="stat-num">50‚Äì65%</div><div class="stat-label">Faster Month-End Close</div></div>
    <div><div class="stat-num">~95%</div><div class="stat-label">Reduction in OU Sprawl</div></div>
    <div><div class="stat-num">40‚Äì60%</div><div class="stat-label">Less IT Customization Effort</div></div>
  </div>

  <div class="ref-panel">
    <div class="ref-panel-header" onclick="toggleRefPanel()">
      <div class="ref-panel-header-left">
        <div>
          <div class="ref-panel-eyebrow">Configuration Reference</div>
          <div class="ref-panel-title">Intracompany vs Intercompany Balancing Rules</div>
        </div>
      </div>
      <div class="ref-panel-toggle" id="refToggle">‚ñº</div>
    </div>
    <div class="ref-panel-body" id="refPanelBody">

      <p class="ref-intro">A common implementation question is whether configuring secondary or tertiary balancing segments requires setting up <strong>intercompany</strong> balancing rules. The answer is no ‚Äî what is required is <strong>intracompany</strong> balancing rules. These are fundamentally different concepts in Oracle Fusion, and confusing them is one of the most frequent configuration mistakes during GL setup.</p>

      <div class="ref-grid">
        <div class="ref-card">
          <span class="ref-card-badge interco">Intercompany Balancing</span>
          <h3>Intercompany Balancing Rules</h3>
          <p>Applies when a transaction crosses <strong>two different legal entities</strong> ‚Äî for example a sale between Company A and Company B under the same group. Fusion generates intercompany receivable and payable entries to keep each legal entity's books balanced.</p>
          <p>This is driven by the <strong>Primary Balancing Segment</strong> and its association to legal entities. It involves two separate sets of books and is governed by the intercompany relationship setup between legal entities.</p>
          <div class="ref-card-detail interco"><strong>Example:</strong> Company 100 (UK) sells goods to Company 200 (France). Fusion auto-posts an intercompany receivable in Company 100 and an intercompany payable in Company 200 to keep both entities balanced.</div>
        </div>
        <div class="ref-card">
          <span class="ref-card-badge intraco">Intracompany Balancing</span>
          <h3>Intracompany Balancing Rules</h3>
          <p>Applies when a transaction crosses <strong>multiple values of a balancing segment within the same legal entity</strong>. This is exactly what secondary and tertiary balancing segments require. Fusion generates Due-To and Due-From lines to ensure every segment value carries a balanced set of financial statements.</p>
          <p>This is configured per ledger and applies independently to the primary, secondary, and tertiary balancing segments. It does <strong>not</strong> involve multiple legal entities.</p>
          <div class="ref-card-detail intraco"><strong>Example:</strong> A journal touches Fund 100 and Fund 200 within Legal Entity 10. Fusion auto-posts a Due-From entry in Fund 100 and a Due-To entry in Fund 200 so both funds independently balance.</div>
        </div>
      </div>

      <div class="ref-table-title">Side-by-Side Comparison</div>
      <table class="ref-compare-table">
        <thead>
          <tr>
            <th>Dimension</th>
            <th>Intercompany</th>
            <th>Intracompany</th>
          </tr>
        </thead>
        <tbody>
          <tr><td>Triggered by</td><td>Transaction crosses legal entities</td><td>Transaction crosses balancing segment values within the same legal entity</td></tr>
          <tr><td>Driven by segment</td><td>Primary Balancing Segment (Legal Entity)</td><td>Secondary or Tertiary Balancing Segment</td></tr>
          <tr><td>Entries generated</td><td>Intercompany receivable / payable</td><td>Due-To / Due-From entries</td></tr>
          <tr><td>Involves multiple legal entities?</td><td class="yes">Yes</td><td class="no">No ‚Äî same legal entity</td></tr>
          <tr><td>Required for secondary / tertiary bal seg?</td><td class="no">No</td><td class="yes">Yes ‚Äî mandatory</td></tr>
          <tr><td>Where configured in Fusion</td><td>Setup and Maintenance ‚Üí Manage Intercompany Balancing Rules</td><td>Setup and Maintenance ‚Üí Manage Intracompany Balancing Rules (under Intercompany menu)</td></tr>
          <tr><td>Configured at level</td><td>Legal Entity or Intercompany Organisation</td><td>Ledger ‚Äî applies across all legal entities in that ledger</td></tr>
          <tr><td>Accounts defined</td><td>Intercompany receivable &amp; payable accounts per entity pair</td><td>Due-From &amp; Due-To accounts per balancing segment value combination</td></tr>
          <tr><td>Can be defaulted / catch-all?</td><td class="yes">Yes ‚Äî default rules by source/category</td><td class="yes">Yes ‚Äî default rules by source/category</td></tr>
          <tr><td>What happens if not configured?</td><td>Intercompany journals error or post to suspense</td><td>Cross-segment journals error or post to suspense ‚Äî blocking dependency</td></tr>
        </tbody>
      </table>

      <div class="ref-warning">
        <strong>‚ö†Ô∏è Implementation Note</strong>
        In Oracle Fusion's Setup and Maintenance navigation, the Intracompany Balancing Rules setup sits within the <em>Intercompany</em> menu path. This causes frequent confusion ‚Äî implementers see "Intercompany" in the navigation and assume they are in the wrong place. They are not. The intracompany rules are correctly located there and must be configured for any ledger using secondary or tertiary balancing segments. Without them, any journal that crosses balancing segment values will fail to post or will route to suspense ‚Äî making this a hard blocking dependency before any transaction processing can begin.
      </div>

    </div>
  </div>

</div>

<script>
function seg(label, freq) { return { label, freq }; }

const coaStructures = {
  "Government / Public Sector": [
    seg("Company", "mandatory"), seg("Fund", "mandatory"), seg("Department", "essential"),
    seg("Natural Acct", "mandatory"), seg("Program", "frequent"), seg("Project", "optional")
  ],
  "Nonprofit / NGO": [
    seg("Entity", "mandatory"), seg("Fund", "mandatory"), seg("Program", "essential"),
    seg("Natural Acct", "mandatory"), seg("Cost Center", "essential"), seg("Restriction", "frequent")
  ],
  "Higher Education": [
    seg("Institution", "mandatory"), seg("Fund", "mandatory"), seg("Dept / School", "essential"),
    seg("Natural Acct", "mandatory"), seg("Program", "frequent"), seg("Grant", "optional")
  ],
  "Healthcare": [
    seg("Legal Entity", "mandatory"), seg("Facility", "common"), seg("Service Line", "frequent"),
    seg("Natural Acct", "mandatory"), seg("Cost Center", "essential"), seg("Payor", "optional")
  ],
  "Banking ‚Äî Line of Business": [
    seg("Legal Entity", "mandatory"), seg("LOB", "common"), seg("Product", "frequent"),
    seg("Natural Acct", "mandatory"), seg("Cost Center", "essential"), seg("Channel", "optional")
  ],
  "Banking ‚Äî Branches": [
    seg("Legal Entity", "mandatory"), seg("Branch", "mandatory"), seg("LOB", "common"),
    seg("Natural Acct", "mandatory"), seg("Cost Center", "essential"), seg("Interco", "frequent")
  ],
  "Banking ‚Äî Trading": [
    seg("Legal Entity", "mandatory"), seg("LOB", "common"), seg("Desk / Product", "frequent"),
    seg("Natural Acct", "mandatory"), seg("Cost Center", "essential"), seg("Interco", "frequent")
  ],
  "Insurance": [
    seg("Legal Entity", "mandatory"), seg("Product Line", "common"), seg("Reg. Line", "frequent"),
    seg("Natural Acct", "mandatory"), seg("Cost Center", "essential"), seg("Channel", "optional")
  ],
  "Airlines": [
    seg("Legal Entity", "mandatory"), seg("Fleet / Route", "common"), seg("MRO / Div", "frequent"),
    seg("Natural Acct", "mandatory"), seg("Cost Center", "essential"), seg("Region", "optional")
  ],
  "Telecommunications": [
    seg("Legal Entity", "mandatory"), seg("Business Seg", "common"), seg("Network / SL", "frequent"),
    seg("Natural Acct", "mandatory"), seg("Cost Center", "essential"), seg("Region", "optional")
  ],
  "Real Estate / Property Management": [
    seg("Legal Entity", "mandatory"), seg("Property", "mandatory"), seg("JV / Fund", "frequent"),
    seg("Natural Acct", "mandatory"), seg("Cost Center", "essential"), seg("Interco", "optional")
  ],
  "Defense / Aerospace": [
    seg("Legal Entity", "mandatory"), seg("Contract", "mandatory"), seg("Program", "frequent"),
    seg("Natural Acct", "mandatory"), seg("Cost Center", "essential"), seg("CLIN", "optional")
  ],
  "Utilities / Energy": [
    seg("Legal Entity", "mandatory"), seg("Reg. Service", "mandatory"), seg("Jurisdiction", "frequent"),
    seg("Natural Acct", "mandatory"), seg("Cost Center", "essential"), seg("Project", "optional")
  ],
  "Oil & Gas": [
    seg("Legal Entity", "mandatory"), seg("Asset / JV", "mandatory"), seg("Field / Project", "frequent"),
    seg("Natural Acct", "mandatory"), seg("Cost Center", "essential"), seg("Interco", "common")
  ],
  "Construction / EPC": [
    seg("Legal Entity", "mandatory"), seg("Project", "mandatory"), seg("JV / Partner", "frequent"),
    seg("Natural Acct", "mandatory"), seg("Cost Center", "essential"), seg("Phase", "optional")
  ],
  "Engineering & Professional Services": [
    seg("Legal Entity", "mandatory"), seg("Engagement", "mandatory"), seg("Practice", "frequent"),
    seg("Natural Acct", "mandatory"), seg("Cost Center", "essential"), seg("Interco", "optional")
  ],
  "Mining & Natural Resources": [
    seg("Legal Entity", "mandatory"), seg("Site / Concess.", "mandatory"), seg("Commodity", "frequent"),
    seg("Natural Acct", "mandatory"), seg("Cost Center", "essential"), seg("Project", "optional")
  ],
  "Hospitality / Hotels": [
    seg("Legal Entity", "mandatory"), seg("Property", "mandatory"), seg("Department", "frequent"),
    seg("Natural Acct", "mandatory"), seg("Cost Center", "essential"), seg("Brand", "optional")
  ],
  "Shipping / Logistics": [
    seg("Legal Entity", "mandatory"), seg("Vessel / Route", "mandatory"), seg("Hub / Region", "frequent"),
    seg("Natural Acct", "mandatory"), seg("Cost Center", "essential"), seg("Charter", "optional")
  ],
  "Pharmaceuticals / Life Sciences": [
    seg("Legal Entity", "mandatory"), seg("Program / Trial", "common"), seg("Therap. Area", "frequent"),
    seg("Natural Acct", "mandatory"), seg("Cost Center", "essential"), seg("Project", "optional")
  ],
  "Manufacturing": [
    seg("Legal Entity", "mandatory"), seg("Plant / Facility", "mandatory"), seg("Product Line", "frequent"),
    seg("Natural Acct", "mandatory"), seg("Cost Center", "essential"), seg("Interco", "common")
  ],
  "Agriculture / Agribusiness": [
    seg("Legal Entity", "mandatory"), seg("Estate / Farm", "mandatory"), seg("Commodity", "frequent"),
    seg("Natural Acct", "mandatory"), seg("Cost Center", "essential"), seg("Season", "optional")
  ]
};

function buildCoaHtml(industry) {
  const segs = coaStructures[industry];
  if (!segs) return '<span style="color:var(--muted);font-size:11px;font-style:italic;">‚Äî</span>';
  return '<div class="coa-structure">' + segs.map((s, i) =>
    `<div class="coa-seg-wrap">
      <span class="coa-seg freq-${s.freq}">${s.label}</span>
      ${i < segs.length - 1 ? '<span class="coa-arrow">‚Ä∫</span>' : ''}
    </div>`
  ).join('') + '</div>';
}

const data = [
  {
    industry: "Government / Public Sector", who: "CFO, Controller, Budget Officer",
    question: "How do you account for public money across funds?",
    segmentType: "secondary", segmentName: "Fund",
    r12Problem: "No fund-level balancing enforcement in GL. Hundreds of manual due-to/due-from entries required each period to force funds to balance. Auditors flag this as a control weakness.",
    r12Workaround: "Manual journal entries at period end to force fund balance. Custom FSG reports to verify fund-level balance. Often involves dedicated headcount just for fund reconciliation.",
    fusionSaving: "Auto balancing lines per fund. Zero manual fund entries. GASB-ready fund reports direct from GL. Complete audit trail on every balancing entry.",
    kpis: [{ icon:"üìâ",value:"70%",label:"reduction in period-end manual journals"},{icon:"‚è±Ô∏è",value:"10‚Üí3 days",label:"close time saved"},{icon:"üîß",value:"40%",label:"less IT customization effort"}]
  },
  {
    industry: "Government / Public Sector", who: "Grants Manager, External Auditor",
    question: "Do federal/state grants need separate, auditable reporting?",
    segmentType: "tertiary", segmentName: "Grant / Program",
    r12Problem: "No system-enforced grant-level balance. Grant reconciliation done outside the GL in spreadsheets. Federal auditors increasingly reject spreadsheet-based grant reports.",
    r12Workaround: "Grants tracked via PA module with manual reconciliation back to GL. Audit prep requires pulling data from two systems and reconciling differences.",
    fusionSaving: "Grant balances natively in GL. Single source of truth for auditors. PA-to-GL reconciliation eliminated entirely.",
    kpis: [{ icon:"üìâ",value:"80%",label:"reduction in grant reconciliation effort"},{icon:"‚è±Ô∏è",value:"50%",label:"audit prep time saved"},{icon:"üí∞",value:"Reduced",label:"external audit fees"}]
  },
  {
    industry: "Nonprofit / NGO", who: "Controller, Board Treasurer, Donor Auditor",
    question: "Do you track restricted vs unrestricted funds with independent balance sheets?",
    segmentType: "secondary", segmentName: "Fund",
    r12Problem: "EBS cannot produce fund-level balance sheets natively. Restricted fund integrity not enforced in GL. Donor reporting produced from spreadsheets ‚Äî a recurring audit risk.",
    r12Workaround: "FSG reports built per fund. Manual monitoring of restricted cash and net assets by fund in Excel. Weeks of staff time consumed every year on fund reporting.",
    fusionSaving: "Fund balance sheet auto-produced from GL. Donor reporting automated. Restricted fund integrity enforced at transaction level.",
    kpis: [{ icon:"üìâ",value:"75%",label:"reduction in fund reporting effort"},{icon:"‚è±Ô∏è",value:"3 days‚Üí4 hrs",label:"donor report production"},{icon:"üîß",value:"3‚Äì5 FSG",label:"custom reports eliminated"}]
  },
  {
    industry: "Nonprofit / NGO", who: "Program Director, Funder Relations",
    question: "Do individual programs need their own P&L for different funders?",
    segmentType: "tertiary", segmentName: "Program",
    r12Problem: "Program reporting relies on cost center tagging with no balance enforcement. Month-end allocation journals done manually. Program P&L built in Discoverer or OBIEE outside GL.",
    r12Workaround: "Manual allocation journals at month end. Program P&L assembled from cost center data in external BI tools. Funder reports require manual compilation.",
    fusionSaving: "Program-level P&L enforced in GL. Funder reports generated directly from system. Month-end allocation journals eliminated.",
    kpis: [{ icon:"üìâ",value:"60%",label:"reduction in month-end allocation journals"},{icon:"‚è±Ô∏è",value:"65%",label:"program report time saved"},{icon:"üí∞",value:"Lower",label:"funder compliance risk"}]
  },
  {
    industry: "Higher Education", who: "VP Finance, Controller, Research Compliance",
    question: "How do you manage federal grants vs tuition vs endowments as separate funds?",
    segmentType: "secondary", segmentName: "Fund",
    r12Problem: "Fund accounting not natively supported. Organizations forced to create separate ledgers per fund ‚Äî causing COA explosion and reporting complexity ‚Äî or produce fund financials manually.",
    r12Workaround: "Multiple ledgers or OUs per fund. Consolidated reporting requires manual aggregation. OMB Uniform Guidance audits rely on manual fund reconciliations.",
    fusionSaving: "Single ledger multi-fund accounting. Simplified COA. Consolidated and fund-level reporting from one ledger. NIH/NSF audit-ready reports from GL.",
    kpis: [{ icon:"üìâ",value:"60%",label:"reduction in ledger maintenance effort"},{icon:"‚è±Ô∏è",value:"8‚Üí3 days",label:"consolidated close"},{icon:"üîß",value:"50%",label:"fewer ledgers to maintain"}]
  },
  {
    industry: "Healthcare", who: "CFO, Facility Controller, CMS Compliance",
    question: "Do individual hospitals or clinics need their own financials for CMS reporting?",
    segmentType: "secondary", segmentName: "Facility",
    r12Problem: "Facility-level balance sheets not enforceable in EBS GL. Inter-facility charges not auto-balanced. Organizations either create one OU per facility (data silos) or run manual inter-facility journals.",
    r12Workaround: "Separate operating units per facility causing data silos, or manual inter-facility journals at month end. Close takes 10‚Äì12 days because of inter-facility reconciliation.",
    fusionSaving: "Facility balance sheet natively produced. Inter-facility entries auto-generated. CMS cost reporting simplified. Month-end close dramatically accelerated.",
    kpis: [{ icon:"üìâ",value:"65%",label:"reduction in inter-facility manual journals"},{icon:"‚è±Ô∏è",value:"40%",label:"CMS report preparation faster"},{icon:"üîß",value:"1 ledger",label:"replaces N operating units"}]
  },
  {
    industry: "Healthcare", who: "Compliance Officer, Revenue Cycle Director",
    question: "Are you subject to cost reporting by service line for Medicare/Medicaid?",
    segmentType: "tertiary", segmentName: "Service Line",
    r12Problem: "Service line costs tracked via cost center but no balance enforcement. Medicare cost reports built manually outside EBS using spreadsheets fed from GL extracts.",
    r12Workaround: "Manual cost report preparation outside EBS. Annual cost report takes 3+ weeks. Auditors review spreadsheet models rather than system-generated reports.",
    fusionSaving: "Service line balances in GL. Cost report preparation automated. Audit risk reduced ‚Äî reports traceable to system entries.",
    kpis: [{ icon:"üìâ",value:"55%",label:"reduction in cost report effort"},{icon:"‚è±Ô∏è",value:"3 wks‚Üí1 wk",label:"annual cost report time"},{icon:"üí∞",value:"Lower",label:"CMS audit exposure"}]
  },
  {
    industry: "Banking ‚Äî Line of Business", who: "CFO, Head of Regulatory Reporting, Chief Risk Officer",
    question: "How do you report P&L and balance sheet by line of business to regulators?",
    segmentType: "secondary", segmentName: "Line of Business",
    r12Problem: "LOB reporting done via management overlay on top of GL. No balance enforcement by LOB in EBS. Extensive Hyperion layer required. LOB-to-GL reconciliation takes 5 days per close cycle.",
    r12Workaround: "Extensive OBIEE/Hyperion layer built on top of EBS. Manual mappings maintained between EBS COA and LOB structure. Reconciliation is the single biggest close bottleneck.",
    fusionSaving: "LOB balances enforced in GL. Hyperion dependency reduced. Regulator-ready LOB reports generated directly from system. Reconciliation eliminated.",
    kpis: [{ icon:"üìâ",value:"70%",label:"reduction in LOB reconciliation effort"},{icon:"‚è±Ô∏è",value:"5‚Üí2 days",label:"regulatory report prep"},{icon:"üîß",value:"40%",label:"Hyperion maintenance cost reduced"}]
  },
  {
    industry: "Banking ‚Äî Branches", who: "Regional Director, Branch Controller, Head of Retail Banking",
    question: "Do branches need their own P&L and balance sheet with inter-branch funding?",
    segmentType: "secondary", segmentName: "Branch",
    r12Problem: "Branch-level balance sheets impossible in EBS without separate OUs per branch. Inter-branch funding not auto-balanced. A bank with 300 branches needs 300 OUs ‚Äî unmanageable at scale.",
    r12Workaround: "Separate OU per branch (unscalable for 100s of branches) or shadow branch accounting maintained in spreadsheets alongside R12. Neither approach gives real-time branch financials.",
    fusionSaving: "Branch balance sheet natively produced. Inter-branch due-to/from auto-generated by system. Architecture scales to thousands of branches without OU sprawl.",
    kpis: [{ icon:"üìâ",value:"80%",label:"reduction in inter-branch reconciliation"},{icon:"‚è±Ô∏è",value:"5 days‚Üísame day",label:"branch close time"},{icon:"üîß",value:"1 OU per branch",label:"eliminated"}]
  },
  {
    industry: "Banking ‚Äî Trading", who: "Controller, Product Controller, Head of Markets",
    question: "Do trading desks or products need to balance independently with real-time P&L?",
    segmentType: "tertiary", segmentName: "Product / Desk",
    r12Problem: "Product-level balance not enforced in GL. Front office systems used as source of truth instead of GL. Front office P&L reconciled manually to GL monthly with frequent breaks.",
    r12Workaround: "Front office P&L systems reconciled manually to GL. Significant reconciliation effort and persistent unresolved differences. GL is not real-time source of truth for desks.",
    fusionSaving: "GL becomes product-level source of truth. Front office-GL reconciliation eliminated. Real-time desk P&L available without waiting for month-end.",
    kpis: [{ icon:"üìâ",value:"75%",label:"reduction in front office-GL reconciliation"},{icon:"‚è±Ô∏è",value:"T+1‚Üíreal-time",label:"daily desk P&L"},{icon:"üí∞",value:"Lower",label:"risk of regulatory reporting errors"}]
  },
  {
    industry: "Insurance", who: "CFO, Actuarial Finance Director, IFRS 17 Lead",
    question: "Do you account separately for insurance products at contract group level for IFRS 17?",
    segmentType: "secondary", segmentName: "Product Line",
    r12Problem: "IFRS 17 contract group accounting not supported in EBS. Actuarial and financial data managed in completely separate systems. IFRS 17 disclosures built entirely outside EBS in spreadsheets.",
    r12Workaround: "Actuarial systems feed summary journals to EBS. IFRS 17 reconciliation takes the entire first week of every close cycle. Disclosures assembled manually in spreadsheet models.",
    fusionSaving: "IFRS 17 contract group balancing native. Actuarial-GL integration simplified. Disclosure automation enabled. Close cycle accelerated significantly.",
    kpis: [{ icon:"üìâ",value:"60%",label:"reduction in IFRS 17 close effort"},{icon:"‚è±Ô∏è",value:"1 wk‚Üí1 day",label:"actuarial-GL reconciliation"},{icon:"üí∞",value:"Lower",label:"IFRS 17 compliance risk"}]
  },
  {
    industry: "Airlines", who: "VP Finance, Controller, Head of Revenue Accounting",
    question: "Do you track financials by fleet type or route profitability?",
    segmentType: "secondary", segmentName: "Fleet / Route",
    r12Problem: "Fleet and route P&L managed in revenue accounting systems outside EBS. GL holds only summary entries at legal entity level. Route-level balance sheets simply do not exist in the GL.",
    r12Workaround: "Revenue accounting system (PROS, Accelya) produces route P&L. Manual summary posted to EBS GL. Reconciliation between systems is monthly and rarely agrees on first pass.",
    fusionSaving: "Route P&L in GL. Revenue system-GL gap closed. Fleet asset tracking integrated. Yield management decisions supported by real-time GL data.",
    kpis: [{ icon:"üìâ",value:"65%",label:"reduction in revenue system-GL reconciliation"},{icon:"‚è±Ô∏è",value:"Monthly‚Üíweekly",label:"route P&L reporting frequency"},{icon:"üí∞",value:"Better",label:"yield management decisions"}]
  },
  {
    industry: "Airlines", who: "Maintenance Finance Manager, MRO Controller",
    question: "Does MRO (maintenance) need separate accounting with chargebacks to operations?",
    segmentType: "tertiary", segmentName: "MRO / Division",
    r12Problem: "MRO chargebacks managed via manual inter-department journals. No system enforcement of MRO balance. MRO P&L reconciled outside EBS in spreadsheets every period.",
    r12Workaround: "Manual recharge journals at month end. MRO P&L assembled outside EBS. MRO profitability benchmarking relies on spreadsheet models not GL data.",
    fusionSaving: "MRO auto-balanced. Recharge journals eliminated. MRO profitability visible directly in GL for benchmarking and make-vs-buy decisions.",
    kpis: [{ icon:"üìâ",value:"70%",label:"reduction in MRO recharge journals"},{icon:"‚è±Ô∏è",value:"4 days‚Üí1 day",label:"MRO close time"},{icon:"üîß",value:"Eliminated",label:"spreadsheet-based MRO P&L"}]
  },
  {
    industry: "Telecommunications", who: "CFO, Segment Controller, Investor Relations Finance",
    question: "Do you report by segment (mobile, broadband, enterprise) for investors and regulators?",
    segmentType: "secondary", segmentName: "Business Segment",
    r12Problem: "Segment reporting done via Hyperion consolidation overlay. EBS GL holds entity-level data only. Manual mappings maintained between EBS COA and segment structure. Quarterly HFM-GL reconciliation is a major drain.",
    r12Workaround: "HFM used to produce segment financials for investor reporting. Manual COA-to-segment mappings maintained. Segment reporting cycle takes 7+ days after close.",
    fusionSaving: "Segment balances enforced in GL. HFM dependency reduced. Investor segment reporting automated. Segment financials available same day as legal entity close.",
    kpis: [{ icon:"üìâ",value:"60%",label:"reduction in segment reporting effort"},{icon:"‚è±Ô∏è",value:"7‚Üí2 days",label:"investor segment report time"},{icon:"üîß",value:"35%",label:"HFM maintenance cost reduced"}]
  },
  {
    industry: "Real Estate / Property Management", who: "CFO, Asset Manager, Property Controller",
    question: "Do individual properties need their own financials for investors and lenders?",
    segmentType: "secondary", segmentName: "Property",
    r12Problem: "Property-level balance sheets require separate OUs per property. A 120-property portfolio means 120 OUs ‚Äî 120 separate closes, 120 setups, 120 report runs. Administration is crushing and consolidated reporting requires Excel.",
    r12Workaround: "One OU per property causing massive admin overhead. Consolidated reporting pulled into Excel. Owner statements produced from manual extracts. Management fee disputes cannot be resolved from system.",
    fusionSaving: "Property balance sheet natively produced. OU explosion eliminated. Portfolio-level and property-level reporting from one ledger. Owner reporting automated.",
    kpis: [{ icon:"üìâ",value:"80%",label:"reduction in property reporting effort"},{icon:"‚è±Ô∏è",value:"5 days‚Üísame day",label:"owner/lender report production"},{icon:"üîß",value:"100 props",label:"= 99 fewer OUs"}]
  },
  {
    industry: "Real Estate / Property Management", who: "JV Manager, Partnership Controller",
    question: "Do joint ventures need independent accounting for each partner?",
    segmentType: "tertiary", segmentName: "Joint Venture",
    r12Problem: "JV accounting done in separate instances or ledgers. Partner statements produced from spreadsheet extracts. Consolidation is manual and error-prone. JV audits rely on external reconciliation models.",
    r12Workaround: "Separate EBS instances or ledgers per JV. Partner reporting via spreadsheet extracts. Consolidation done manually. JV audit preparation takes weeks.",
    fusionSaving: "JV balance sheet in single ledger. Partner reporting automated. Consolidation simplified. JV audit conducted from system reports.",
    kpis: [{ icon:"üìâ",value:"70%",label:"reduction in JV consolidation effort"},{icon:"‚è±Ô∏è",value:"1 wk‚Üí1 day",label:"partner statement production"},{icon:"üí∞",value:"20‚Äì30%",label:"reduction in external audit costs"}]
  },
  {
    industry: "Defense / Aerospace", who: "Controller, Contracts Manager, DCAA Liaison",
    question: "Do government contracts need independent cost accounting for DCAA and CAS compliance?",
    segmentType: "secondary", segmentName: "Contract",
    r12Problem: "Contract cost accounting done in Projects module. GL only balances at legal entity level. Contract-level balance sheet cannot be produced from GL. DCAA audits rely on PA reports and spreadsheet models.",
    r12Workaround: "Oracle Projects used for contract tracking. DCAA reports built from PA extracts. PA-to-GL reconciliation required. Audit preparation takes weeks and is heavily manual.",
    fusionSaving: "Contract balance enforced in GL. DCAA audit conducted directly from GL. PA-GL reconciliation eliminated. Contract-level balance sheet available on demand.",
    kpis: [{ icon:"üìâ",value:"65%",label:"reduction in DCAA audit preparation"},{icon:"‚è±Ô∏è",value:"3‚Äì5 days/period",label:"PA-GL reconciliation eliminated"},{icon:"üí∞",value:"Lower",label:"risk of contract cost disallowances"}]
  },
  {
    industry: "Utilities / Energy", who: "CFO, Regulatory Affairs Director, Rate Case Manager",
    question: "Do regulators require separate financial statements by service type (electric, gas, water)?",
    segmentType: "secondary", segmentName: "Regulated Service",
    r12Problem: "Regulated service separation done via COA workarounds. FERC reports built manually using FSG or custom BI tools. Rate case preparation involves weeks of manual cost studies.",
    r12Workaround: "Separate account ranges per service type in COA. FERC reports built in FSG or custom BI tools. Rate case cost studies compiled manually from GL extracts in spreadsheets.",
    fusionSaving: "FERC-compliant balancing native. FSG custom reports eliminated. Rate case preparation significantly faster. Regulatory submission quality improved.",
    kpis: [{ icon:"üìâ",value:"55%",label:"reduction in FERC reporting effort"},{icon:"‚è±Ô∏è",value:"4 wks‚Üí2 wks",label:"rate case preparation time"},{icon:"üîß",value:"5‚Äì10 FSG",label:"custom reports eliminated"}]
  },
  {
    industry: "Oil & Gas", who: "CFO, JV Accounting Manager, Partner Relations",
    question: "Do JVs or production sharing agreements need auditable asset-level financials for partners?",
    segmentType: "secondary", segmentName: "Asset / JV",
    r12Problem: "JV accounting done in JV module or separate ledgers. Partner statements produced manually from PA extracts. A permanent team dedicated to JV reconciliation is common at large operators.",
    r12Workaround: "Oracle JV Accounting module used with manual partner statement production. Partner reporting process takes 1+ week per cycle. 4-person reconciliation teams not uncommon.",
    fusionSaving: "JV balance native in GL. Partner statements automated. JV module customization reduced. Reconciliation team effort dramatically reduced.",
    kpis: [{ icon:"üìâ",value:"70%",label:"reduction in JV accounting effort"},{icon:"‚è±Ô∏è",value:"1 wk‚Üí1 day",label:"partner statement turnaround"},{icon:"üîß",value:"50%",label:"JV module customization reduced"}]
  },
  {
    industry: "Construction / EPC", who: "CFO, Project Accountant, Lender Representative",
    question: "Do construction projects need their own balance sheets for project finance lenders?",
    segmentType: "secondary", segmentName: "Project",
    r12Problem: "Project balance sheets not enforceable in EBS GL. Project accounting done entirely in PA module. Lender reports built from PA extracts and manually reconciled to GL ‚Äî taking 1 week per month.",
    r12Workaround: "Oracle Projects used for project tracking. Lender and owner reports built from PA extracts. Monthly lender report production consumes one week of project accounting team time.",
    fusionSaving: "Project balance sheet in GL. Lender reporting automated. PA-GL single source of truth. Lender covenant compliance tracked in real time.",
    kpis: [{ icon:"üìâ",value:"70%",label:"reduction in project reporting effort"},{icon:"‚è±Ô∏è",value:"1 wk‚Üí1 day",label:"lender report turnaround"},{icon:"üîß",value:"3‚Äì4 days/period",label:"PA-GL reconciliation eliminated"}]
  },
  {
    industry: "Construction / EPC", who: "JV Manager, Consortium Controller",
    question: "Do JVs or consortiums need independent accounting for each partner?",
    segmentType: "tertiary", segmentName: "JV / Partner",
    r12Problem: "JV partner reporting done via manual extracts from PA. Equity share balancing calculated in spreadsheets. Auditors rely on spreadsheet models rather than system-generated reports.",
    r12Workaround: "Manual partner statements at project milestones. Audit support consists of spreadsheet models. Partner disputes require manual reconciliation of PA data.",
    fusionSaving: "JV partner balance native in GL. Milestone reporting automated. Audit conducted from system reports not spreadsheets.",
    kpis: [{ icon:"üìâ",value:"65%",label:"reduction in JV audit preparation"},{icon:"‚è±Ô∏è",value:"1 wk‚Üísame day",label:"partner statement production"},{icon:"üí∞",value:"20‚Äì30%",label:"reduction in external audit fees"}]
  },
  {
    industry: "Engineering & Professional Services", who: "Engagement Controller, Managing Partner, CFO",
    question: "Do client engagements need their own P&L and WIP balance sheet?",
    segmentType: "secondary", segmentName: "Engagement / Contract",
    r12Problem: "Engagement P&L and WIP tracked in Projects. GL holds summary entries only. Client-level balance sheet not available from GL. Partners make decisions based on PA reports not GL.",
    r12Workaround: "PA module used for engagement tracking. Client reporting done via PA reports. Revenue recognition managed manually. Client invoice disputes cannot be resolved from GL.",
    fusionSaving: "Engagement balance in GL. WIP balance sheet native. Revenue recognition automated per contract. Client disputes resolved from system-generated GL reports.",
    kpis: [{ icon:"üìâ",value:"60%",label:"reduction in engagement reporting effort"},{icon:"‚è±Ô∏è",value:"Monthly‚Üíweekly",label:"client P&L frequency"},{icon:"üí∞",value:"Lower",label:"revenue recognition risk"}]
  },
  {
    industry: "Engineering & Professional Services", who: "Practice Lead, Managing Partner",
    question: "Do service practices need their own P&L for partner compensation?",
    segmentType: "tertiary", segmentName: "Practice / Service Line",
    r12Problem: "Practice P&L managed via cost center hierarchy with no balance enforcement. Partner compensation calculated from manual Excel models not GL data. Practice-level carve-outs require major effort.",
    r12Workaround: "Practice financials built in Hyperion or Excel from EBS cost center data. Partner draws calculated manually. Practice P&L reconciliation is a recurring, contentious exercise.",
    fusionSaving: "Practice balance in GL. Partner compensation data sourced from GL. Excel-based practice P&L eliminated. Compensation disputes resolved from system reports.",
    kpis: [{ icon:"üìâ",value:"70%",label:"reduction in practice reporting effort"},{icon:"‚è±Ô∏è",value:"2 wks‚Üí3 days",label:"partner compensation cycle"},{icon:"üîß",value:"Eliminated",label:"Excel-based practice P&L"}]
  },
  {
    industry: "Mining & Natural Resources", who: "CFO, Site Controller, Royalty Accounting Manager",
    question: "Do individual mine sites need their own financials for royalty and environmental reporting?",
    segmentType: "secondary", segmentName: "Site / Concession",
    r12Problem: "Site-level balance sheets require separate ledgers per site. Royalty calculations done outside EBS. Environmental liability tracking manual. 8 sites = 8 ledgers = 8 separate close processes.",
    r12Workaround: "Separate ledgers per site. Royalty reporting done in spreadsheets and checked against GL manually each quarter. Environmental liability balances maintained outside system.",
    fusionSaving: "Site balance sheet natively produced. Royalty reporting automated. Environmental liability tracked in GL. Single ledger replaces multiple site ledgers.",
    kpis: [{ icon:"üìâ",value:"65%",label:"reduction in site reporting effort"},{icon:"‚è±Ô∏è",value:"1 wk‚Üí1 day",label:"royalty calculation cycle"},{icon:"üí∞",value:"Lower",label:"environmental liability audit risk"}]
  },
  {
    industry: "Hospitality / Hotels", who: "CFO, Property Controller, Asset Manager",
    question: "Do individual hotels need their own financials per management contract and owner?",
    segmentType: "secondary", segmentName: "Property",
    r12Problem: "Property-level balance sheets require separate OUs. 60 properties = 60 OUs = 60 separate close processes. Owner statements produced from manual extracts. Management fee disputes cannot be resolved from system.",
    r12Workaround: "One OU per hotel. Owner statements produced from manual extracts each month. Management fee calculations done in Excel. Franchise/brand reporting requires separate manual compilation.",
    fusionSaving: "Property balance sheet native. Owner reporting automated. Management fee calculation in GL. 60 properties managed from one ledger.",
    kpis: [{ icon:"üìâ",value:"75%",label:"reduction in property reporting effort"},{icon:"‚è±Ô∏è",value:"1 wk‚Üísame day",label:"owner statement production"},{icon:"üîß",value:"50 hotels",label:"= 49 fewer operating units"}]
  },
  {
    industry: "Hospitality / Hotels", who: "F&B Manager, Revenue Manager, Department Head",
    question: "Do departments (F&B, Rooms, Spa) need to balance independently under USALI standards?",
    segmentType: "tertiary", segmentName: "Department",
    r12Problem: "USALI departmental reporting built via FSG on cost center data. No inter-department balance enforcement. Inter-department chargebacks (laundry, kitchen) done via manual journals each period.",
    r12Workaround: "FSG reports per department. Inter-department chargebacks managed via manual journals. USALI compliance dependent on manual controls not system enforcement.",
    fusionSaving: "USALI balance native. Inter-department entries auto-generated. FSG custom reports eliminated. USALI compliance enforced at transaction level.",
    kpis: [{ icon:"üìâ",value:"60%",label:"reduction in departmental reporting effort"},{icon:"‚è±Ô∏è",value:"3 days‚Üísame day",label:"USALI report production"},{icon:"üîß",value:"Eliminated",label:"inter-department manual journals"}]
  },
  {
    industry: "Shipping / Logistics", who: "CFO, Vessel Controller, Charter Accounting Manager",
    question: "Do individual vessels need their own P&L with charter agreement accounting?",
    segmentType: "secondary", segmentName: "Vessel / Route",
    r12Problem: "Vessel-level P&L managed in maritime ERP alongside EBS. GL holds aggregated fleet data only. Monthly reconciliation between maritime system and GL regularly produces differences taking days to resolve.",
    r12Workaround: "Maritime systems (Orca, Shipnet) feed summary to EBS. Vessel P&L reconciled manually. Incorrect vessel P&L reported to investors has occurred due to reconciliation failures.",
    fusionSaving: "Vessel balance in GL. Maritime system-GL gap closed. Charter billing integrated. Investor reporting accuracy improved.",
    kpis: [{ icon:"üìâ",value:"65%",label:"reduction in vessel reconciliation effort"},{icon:"‚è±Ô∏è",value:"Monthly‚Üíweekly",label:"vessel P&L reporting frequency"},{icon:"üí∞",value:"Reduced",label:"charter billing disputes"}]
  },
  {
    industry: "Pharmaceuticals / Life Sciences", who: "CFO, R&D Finance Manager, Clinical Trial Sponsor",
    question: "Do clinical trials need independent financials for sponsor reporting?",
    segmentType: "secondary", segmentName: "Program / Trial",
    r12Problem: "Trial-level balance sheets not in GL. Clinical trial costs tracked in PA or CTMS systems. With 35 active trials, the PA-to-GL reconciliation process is a permanent full-time job for 2 people.",
    r12Workaround: "CTMS feeds summary to EBS. Trial P&L reconciled manually. Sponsor reports built outside GL. Reconciliation team of 2 FTEs permanently dedicated to this task.",
    fusionSaving: "Trial balance in GL. Sponsor reporting automated. CTMS-GL reconciliation eliminated. Dedicated reconciliation headcount freed for higher-value work.",
    kpis: [{ icon:"üìâ",value:"70%",label:"reduction in trial reporting effort"},{icon:"‚è±Ô∏è",value:"2 wks‚Üí2 days",label:"sponsor report turnaround"},{icon:"üí∞",value:"2 FTEs",label:"reconciliation headcount freed"}]
  },
  {
    industry: "Manufacturing", who: "Plant Controller, CFO, Intercompany Accounting Manager",
    question: "Do individual plants need their own balance sheets as profit centers?",
    segmentType: "secondary", segmentName: "Plant / Facility",
    r12Problem: "Plant-level balance sheets require separate OUs. Inter-plant transfers generate intercompany invoices that flood AP and AR. One company with 15 plants processes 2,000+ intercompany invoices per month that exist only to force balance.",
    r12Workaround: "One OU per plant. Inter-plant transactions managed via intercompany invoicing. AP/AR volume bloated with artificial intercompany transactions. Matching and reconciliation is a permanent burden.",
    fusionSaving: "Plant balance sheet native. Intercompany invoice volume reduced by 50%+. Plant controller reporting automated. Working capital managed at plant level in real time.",
    kpis: [{ icon:"üìâ",value:"65%",label:"reduction in inter-plant reconciliation"},{icon:"‚è±Ô∏è",value:"4 days‚Üí1 day",label:"plant close time"},{icon:"üîß",value:"50%+",label:"intercompany invoice volume reduced"}]
  },
  {
    industry: "Manufacturing", who: "Product Line Manager, Commercial Finance Director",
    question: "Do product lines need independent P&Ls for margin management?",
    segmentType: "tertiary", segmentName: "Product Line",
    r12Problem: "Product line P&L managed via cost center rollups. No balance enforcement. Margin analysis done in OBIEE or Hyperion outside GL. Pricing decisions rely on BI tools not GL data.",
    r12Workaround: "Product costing in Oracle Cost Management. Product line P&L built in OBIEE or Hyperion outside GL. Margin reports require extraction, transformation, and loading from multiple sources.",
    fusionSaving: "Product line balance in GL. Margin analysis from GL directly. Cost Management-GL alignment. Pricing decisions supported by real-time GL data.",
    kpis: [{ icon:"üìâ",value:"55%",label:"reduction in product line reporting effort"},{icon:"‚è±Ô∏è",value:"Monthly‚Üíweekly",label:"margin report frequency"},{icon:"üí∞",value:"Reduced",label:"OBIEE product layer maintenance"}]
  },
  {
    industry: "Agriculture / Agribusiness", who: "CFO, Estate Manager, Cooperative Finance Director",
    question: "Do individual farms or estates need their own financials for cooperative reporting?",
    segmentType: "secondary", segmentName: "Estate / Farm",
    r12Problem: "Farm-level balance sheets require separate OUs. Cooperative member reporting done in spreadsheets because GL cannot produce estate-level balance sheets that roll up to member equity positions. Auditors flag this as a material weakness.",
    r12Workaround: "Separate OUs per estate. Cooperative member reporting done via manual extracts. Member equity positions calculated in Excel. External auditors have flagged spreadsheet-based member reporting.",
    fusionSaving: "Farm balance sheet native. Cooperative reporting automated. OU sprawl eliminated. Member equity positions calculated from GL data.",
    kpis: [{ icon:"üìâ",value:"65%",label:"reduction in farm reporting effort"},{icon:"‚è±Ô∏è",value:"1 wk‚Üí1 day",label:"cooperative report turnaround"},{icon:"üîß",value:"Eliminated",label:"material weakness from spreadsheet reporting"}]
  }
];

let currentFilter = 'all';
let currentIndustry = 'all';
let currentSort = { col: null, dir: 'asc' };
let expandedRows = new Set();

function renderTable(rows) {
  const tbody = document.getElementById('tableBody');
  tbody.innerHTML = '';

  rows.forEach((row, idx) => {
    const segClass = row.segmentType === 'secondary' ? 'seg-secondary' : 'seg-tertiary';
    const segLabel = row.segmentType === 'secondary' ? 'Secondary Bal. Seg.' : 'Tertiary Bal. Seg.';
    const kpiHtml = row.kpis.map(k =>
      `<div class="kpi-item"><span class="kpi-icon">${k.icon}</span><span class="kpi-value">${k.value}</span><span>${k.label}</span></div>`
    ).join('');
    const coaHtml = buildCoaHtml(row.industry);

    const tr = document.createElement('tr');
    tr.dataset.idx = idx;
    tr.innerHTML = `
      <td class="td-industry">${row.industry}</td>
      <td class="td-who">${row.who}</td>
      <td class="td-question">"${row.question}"</td>
      <td class="td-segment">
        <span class="seg-badge ${segClass}">${segLabel}</span>
        <span class="seg-name">${row.segmentName}</span>
      </td>
      <td class="td-coa">${coaHtml}</td>
      <td class="td-kpi">${kpiHtml}</td>
      <td><button class="expand-btn" title="View details">‚ñº</button></td>
    `;
    const detailTr = document.createElement('tr');
    detailTr.className = 'detail-row';
    detailTr.innerHTML = `
      <td class="detail-cell" colspan="7">
        <div class="detail-inner">
          <div class="detail-block"><h4>üî¥ Problem in Oracle R12</h4><p>${row.r12Problem}</p></div>
          <div class="detail-block"><h4>üü° R12 Workaround</h4><p>${row.r12Workaround}</p></div>
          <div class="detail-block"><h4>üü¢ What Fusion Delivers</h4><p>${row.fusionSaving}</p></div>
        </div>
      </td>
    `;
    tr.addEventListener('click', () => {
      const isExp = expandedRows.has(idx);
      if (isExp) { expandedRows.delete(idx); tr.classList.remove('expanded'); detailTr.classList.remove('visible'); }
      else { expandedRows.add(idx); tr.classList.add('expanded'); detailTr.classList.add('visible'); }
    });
    tbody.appendChild(tr);
    tbody.appendChild(detailTr);
  });

  document.getElementById('resultsCount').textContent = `${rows.length} use case${rows.length !== 1 ? 's' : ''}`;
  document.getElementById('noResults').style.display = rows.length === 0 ? 'block' : 'none';
}

function getFilteredSorted() {
  const query = document.getElementById('searchInput').value.toLowerCase().trim();
  let rows = data.filter(row => {
    const mF = currentFilter === 'all' || row.segmentType === currentFilter;
    const mI = currentIndustry === 'all' || row.industry === currentIndustry;
    const mS = !query ||
      row.industry.toLowerCase().includes(query) ||
      row.who.toLowerCase().includes(query) ||
      row.question.toLowerCase().includes(query) ||
      row.segmentName.toLowerCase().includes(query) ||
      row.r12Problem.toLowerCase().includes(query) ||
      row.fusionSaving.toLowerCase().includes(query);
    return mF && mI && mS;
  });
  if (currentSort.col) {
    rows = rows.sort((a, b) => {
      const va = a[currentSort.col]?.toLowerCase?.() || '';
      const vb = b[currentSort.col]?.toLowerCase?.() || '';
      return currentSort.dir === 'asc' ? va.localeCompare(vb) : vb.localeCompare(va);
    });
  }
  return rows;
}

function refresh() { expandedRows.clear(); renderTable(getFilteredSorted()); }

// Populate dropdown
const select = document.getElementById('industrySelect');
[...new Set(data.map(d => d.industry))].sort().forEach(ind => {
  const opt = document.createElement('option');
  opt.value = ind; opt.textContent = ind;
  select.appendChild(opt);
});

select.addEventListener('change', e => { currentIndustry = e.target.value; refresh(); });

document.querySelectorAll('.filter-btn').forEach(btn => {
  btn.addEventListener('click', () => {
    document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
    currentFilter = btn.dataset.filter;
    refresh();
  });
});

document.getElementById('searchInput').addEventListener('input', refresh);

document.querySelectorAll('th[data-col]').forEach(th => {
  th.addEventListener('click', () => {
    const col = th.dataset.col;
    currentSort.dir = currentSort.col === col && currentSort.dir === 'asc' ? 'desc' : 'asc';
    currentSort.col = col;
    document.querySelectorAll('th').forEach(t => t.classList.remove('sorted'));
    th.classList.add('sorted');
    th.querySelector('.sort-icon').textContent = currentSort.dir === 'asc' ? '‚Üë' : '‚Üì';
    refresh();
  });
});

document.getElementById('statIndustries').textContent = Object.keys(coaStructures).length;
renderTable(data);

function toggleRefPanel() {
  const body = document.getElementById('refPanelBody');
  const toggle = document.getElementById('refToggle');
  const isOpen = body.classList.contains('open');
  body.classList.toggle('open', !isOpen);
  toggle.classList.toggle('open', !isOpen);
}
</script>
</body>
</html>
